'use strict';class da{constructor(a,b,c){this.a=a;this.i=b;this.m=c}bind(a){a.bindTexture(a.TEXTURE_2D,this.a)}};function m(a){for(let b=0;3>b;++b)for(let c=0;3>c;++c)a.l[3*b+c]=b==c?1:0}function t(a,b,c){m(a);a.l[0]=2/(b-0);a.l[2]=-(b+0)/(b-0);a.l[4]=2/(0-c);a.l[5]=-(0+c)/(0-c);a.l[8]=1}function v(a){let b=new w;for(let c=0;3>c;++c)for(let d=0;3>d;++d)b.l[3*d+c]=a.l[3*c+d];return b}
class w{constructor(){this.l=new Float32Array(9);m(this)}multiply(a){let b=new w;for(var c=0;3>c;++c)for(var d=0;3>d;++d)b.l[3*c+d]=0;for(c=0;3>c;++c)for(d=0;3>d;++d)for(let e=0;3>e;++e)b.l[3*c+d]+=this.l[3*c+e]*a.l[3*e+d];return b}translate(a,b){m(this);this.l[2]=a;this.l[5]=b}scale(a,b){m(this);this.l[0]=a;this.l[4]=b}rotate(a){let b=Math.cos(a);a=Math.sin(a);m(this);this.l[0]=b;this.l[1]=-a;this.l[3]=a;this.l[4]=b}clone(){let a=new w;for(let b=0;9>b;++b)a.l[b]=this.l[b];return a}};function x(a,b,c,d,e){let g=a.b;g.uniform2f(a.H,b,c);g.uniform2f(a.M,d,e)}function z(a){var b=a.b;b.useProgram(a.a);b.uniform1i(a.O,0);x(a,0,0,1,1);b=a.b;b.uniform2f(a.g,0,0);b.uniform2f(a.h,1,1);b=new w;a.b.uniformMatrix3fv(a.j,!1,v(b).l)}
class A{constructor(a,b,c){this.b=a;this.a=null;{let d=this.b;b=this.createShader(b,d.VERTEX_SHADER);c=this.createShader(c,d.FRAGMENT_SHADER);this.a=d.createProgram();d.attachShader(this.a,b);d.attachShader(this.a,c);c=this.b;c.bindAttribLocation(this.a,0,"v");c.bindAttribLocation(this.a,1,"uvp");d.linkProgram(this.a);if(!d.getProgramParameter(this.a,d.LINK_STATUS))throw"Shader error: "+d.getProgramInfoLog(this.a);}this.j=a.getUniformLocation(this.a,"transform");this.w=a.getUniformLocation(this.a,
"color");this.O=a.getUniformLocation(this.a,"t0");this.H=a.getUniformLocation(this.a,"pos");this.M=a.getUniformLocation(this.a,"size");this.g=a.getUniformLocation(this.a,"texPos");this.h=a.getUniformLocation(this.a,"texSize")}createShader(a,b){let c=this.b;b=c.createShader(b);c.shaderSource(b,a);c.compileShader(b);if(!c.getShaderParameter(b,c.COMPILE_STATUS))throw"Shader error:\n"+c.getShaderInfoLog(b);return b}f(a,b,c,d){this.b.uniform4f(this.w,a,b,c,d)}};class B{constructor(a,b){this.x=null==a?0:a;this.y=null==b?0:b}clone(){return new B(this.x,this.y)}};function D(a){if(null!=a.b){a.G||(a.H=a.P.multiply(a.F),a.G=!0);var b=a.b;b.b.uniformMatrix3fv(b.j,!1,v(a.H).l)}}
class ea{constructor(){this.P=new w;this.F=new w;this.H=new w;this.h=new w;this.viewport=new B;this.G=!1;this.b=null;this.j=[]}translate(a,b){this.h.translate(a,b);this.F=this.F.multiply(this.h);this.G=!1}scale(a,b){this.h.scale(a,b);this.F=this.F.multiply(this.h);this.G=!1}rotate(a){this.h.rotate(a);this.F=this.F.multiply(this.h);this.G=!1}push(){this.j.push(this.F.clone());if(64<=this.j.length)throw"Stack overflow!";}pop(){this.F=this.j.pop().clone();this.G=!1;D(this)}};class E{constructor(a,b,c,d){this.h=d.length;this.g=a.createBuffer();this.b=a.createBuffer();this.a=a.createBuffer();a.bindBuffer(a.ARRAY_BUFFER,this.g);a.bufferData(a.ARRAY_BUFFER,new Float32Array(b),a.STATIC_DRAW);a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,this.a);a.bufferData(a.ELEMENT_ARRAY_BUFFER,new Uint16Array(d),a.STATIC_DRAW);a.bindBuffer(a.ARRAY_BUFFER,this.b);a.bufferData(a.ARRAY_BUFFER,new Float32Array(c),a.STATIC_DRAW)}bind(a){a.bindBuffer(a.ARRAY_BUFFER,this.g);a.vertexAttribPointer(0,2,a.FLOAT,
a.V,0,0);a.bindBuffer(a.ARRAY_BUFFER,this.b);a.vertexAttribPointer(1,2,a.FLOAT,a.V,0,0);a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,this.a)}v(a){a.drawElements(a.TRIANGLES,this.h,a.UNSIGNED_SHORT,0)}};function G(a,b,c,d,e){b=null!=b?Math.min(b,32):32;let g=2*Math.PI/32,f,h=[],k=[],l=0,n=!1,p=1;for(let q=0;q<b;++q)c&&++l>=c&&(p=(n=!n)?1+d:1,l-=c),f=g*q,e?(h.push(e*Math.cos(f),e*Math.sin(f),Math.cos(f)*p,Math.sin(f)*p,Math.cos(f+g)*p,Math.sin(f+g)*p),h.push(e*Math.cos(f),e*Math.sin(f),e*Math.cos(f+g),e*Math.sin(f+g),Math.cos(f+g)*p,Math.sin(f+g)*p)):h.push(0,0,Math.cos(f)*p,Math.sin(f)*p,Math.cos(f+g)*p,Math.sin(f+g)*p);b*=3;e&&(b*=2);for(e=0;e<b;++e)k.push(e);return new E(a.a,h,h,k)}
function fa(a,b){var c;null==c&&(c=2*Math.PI);let d=c/24;c=[];let e=[],g,f;for(let h=0;24>h;++h)g=b(d*h),f=b(d*(h+1)),c.push(g[0],g[1],f[0],f[1],0,0);for(b=0;72>b;++b)e.push(b);return new E(a.a,c,c,e)}function ha(a){var b=10;var c=2*Math.PI/b;let d=[],e=[],g,f;for(let h=0;h<b;++h)g=0==h%2?1:2,f=0==h%2?2:1,d.push(Math.cos(c*h)*g,Math.sin(c*h)*g,Math.cos(c*(h+1))*f,Math.sin(c*(h+1))*f,0,0);b*=3;for(c=0;c<b;++c)e.push(c);return new E(a.a,d,d,e)}class ia{constructor(a){this.a=a}};function I(a,b){return Math.max(0,Math.min(a,b))};function ja(a){let b=new ia(a.a);a.w=[new E(b.a,[0,0,1,0,1,1,0,1],[0,0,1,0,1,1,0,1],[0,1,2,2,3,0]),new E(b.a,[0,0,1,1,0,1],[0,0,1,1,0,1],[0,1,2]),new E(b.a,[0,-1,.71,.71,-.71,.71],[0,0,1,1,0,1],[0,1,2]),G(b),G(b,null,2,.25,.33),fa(b,c=>[Math.cos(1.25*(c-Math.PI)/4)*Math.sin(c-Math.PI),Math.cos(c-Math.PI)]),ha(b),G(b,16)]}function J(a){var b=window.innerWidth,c=window.innerHeight;a.g.width=b;a.g.height=c;a.a.viewport(0,0,b,c);a.i=a.g.width;a.m=a.g.height;a.top=-1;a.left=-a.i/a.m}
function K(a,b,c,d,e,g,f){let h=a.a;null!=d&&x(a.b,d,e,g,f);a.O!=b&&(b.bind(h),a.O=b);null!=c&&c.bind(h);b.v(h)}function L(a,b,c,d,e,g){0>e&&(c-=e);0>g&&(d-=g);K(a,a.w[I(b|0,a.w.length-1)],null,c,d,e,g)}
function M(a,b,c,d,e,g,f,h,k,l){let n=a.M.i/16,p=d;let q=g/64,r=f/64;d=c-=b.length/2*(n+e)*q;let F=0;for(let H=0;H<b.length;++H){var u=b.charCodeAt(H);if(10==u)d=c,p+=(n+0)*r;else{null!=h&&(F=Math.sin(l+H*h)*k);var C=a,y=a.M,wa=u%16*n;u=(u/16|0)*n;var aa=n,ba=n;x(C.b,d,p+F,g,f);{var N=C.b;aa/=y.i;ba/=y.m;let ca=N.b;ca.uniform2f(N.g,wa/y.i,u/y.m);ca.uniform2f(N.h,aa,ba)}K(C,C.w[0],y);d+=(n+e)*q}}}function O(a,b){a.b=b?a.T:a.U;z(a.b);a.f(1,1,1,1);D(a)}
class ka extends ea{constructor(){super();var a=document.createElement("div");a.setAttribute("style","position: absolute; top: 0; left: 0; z-index: -1");this.g=document.createElement("canvas");this.g.width=window.innerWidth;this.g.height=window.innerHeight;this.g.setAttribute("style","position: absolute; top: 0; left: 0; z-index: -1");a.appendChild(this.g);document.body.appendChild(a);this.a=null;a=this.a=this.g.getContext("webgl",{alpha:!1});if(null===a)throw"Failed to initialize WebGL.";a.activeTexture(a.TEXTURE0);
a.disable(a.DEPTH_TEST);a.enable(a.BLEND);a.blendFuncSeparate(a.SRC_ALPHA,a.ONE_MINUS_SRC_ALPHA,a.ONE,a.ONE_MINUS_SRC_ALPHA);a.enableVertexAttribArray(0);a.enableVertexAttribArray(1);ja(this);this.U=new A(this.a,"\nattribute vec2 v;\nattribute vec2 uvp;\n   \nuniform mat3 transform;\n\nuniform vec2 pos;\nuniform vec2 size;\n\nvarying vec2 uv;\n   \nvoid main() {\n\n    vec3 op = transform * vec3(v * size + pos, 1);\n    gl_Position = vec4(op, 1);\n    uv = uvp;\n}","\nprecision mediump float;\n \nuniform sampler2D t0;\nuniform vec4 color;\n\nuniform vec2 texPos;\nuniform vec2 texSize;\n\nvarying vec2 uv;\n\nvoid main() {\n\n    gl_FragColor = color;\n}\n");
this.b=this.T=new A(this.a,"\nattribute vec2 v;\nattribute vec2 uvp;\n   \nuniform mat3 transform;\n\nuniform vec2 pos;\nuniform vec2 size;\n\nvarying vec2 uv;\n   \nvoid main() {\n\n    vec3 op = transform * vec3(v * size + pos, 1);\n    gl_Position = vec4(op, 1);\n    uv = uvp;\n}","\nprecision mediump float;\n \nuniform sampler2D t0;\nuniform vec4 color;\n\nuniform vec2 texPos;\nuniform vec2 texSize;\n\nvarying vec2 uv;\n\nvoid main() {\n      \n    const float DELTA = 0.001;\n    vec2 tex = uv;    \n    tex.x *= texSize.x;\n    tex.y *= texSize.y;\n    tex += texPos;\n    vec4 res = color * texture2D(t0, tex);\n    if(res.a <= DELTA) {\n        discard;\n    }\n    gl_FragColor = res;\n}\n");
z(this.b);{a=document.createElement("canvas");a.width=1024;a.height=1024;var b=a.getContext("2d");b.font="56px sans-serif";b.textAlign="center";let e;for(let g=33;123>g;++g){var c=g%16;e=g/16|0;b.fillStyle="#000000";for(var d=-3;3>=d;++d)for(let f=-3;3>=f;++f)if(d!=f||0!=d)for(let h=-2;2>=h;++h)b.fillText(String.fromCharCode(g),64*c+32+h+d,64*e+48+f);b.fillStyle="#FFFFFF";for(d=-2;2>=d;++d)b.fillText(String.fromCharCode(g),64*c+32+d,64*e+48)}b=this.a;c=b.createTexture();b.bindTexture(b.TEXTURE_2D,
c);b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MIN_FILTER,b.LINEAR);b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MAG_FILTER,b.LINEAR);b.texImage2D(b.TEXTURE_2D,0,b.RGBA,b.RGBA,b.UNSIGNED_BYTE,a);a.remove();this.M=new da(c,1024,1024)}this.O=null;J(this);this.I=1}clear(a,b,c){let d=this.a;d.clearColor(a,b,c,1);d.clear(d.COLOR_BUFFER_BIT)}f(a,b,c,d){null==a&&(a=1);null==b&&(b=1);null==c&&(c=1);null==d&&(d=1);this.b.f(a,b,c,d*this.I)}};class la{constructor(){this.keys={};window.addEventListener("keydown",a=>{a.preventDefault();a=a.keyCode;1!=this.keys[a]&&(this.keys[a]=2)});window.addEventListener("keyup",a=>{a.preventDefault();a=a.keyCode;0!=this.keys[a]&&(this.keys[a]=3)})}update(){for(let a in this.keys)2==this.keys[a]?this.keys[a]=1:3==this.keys[a]&&(this.keys[a]=0)}getKey(a){return this.keys[a]|0}};function ma(a,b){a.b+=b-a.j;let c=Math.floor(a.b/a.target)|0,d=0<c;5<c&&(a.b=5*a.target,c=5);for(;0<c--;)null!=a.a&&null!=a.a.update&&a.a.update(a.h),a.h.input.update(),a.b-=a.target;d&&null!=a.a&&null!=a.a.v&&a.a.v(a.g);a.j=b;window.requestAnimationFrame(e=>ma(a,e))}class na{constructor(){this.w=[];this.a=null;this.j=this.b=0;this.frameRate=30;this.target=0;this.h={W:this,input:new la};this.g=new ka(128,96);window.addEventListener("resize",()=>J(this.g))}};const oa=[{i:7,m:7,data:[8,1,2,0,1,3,1,0,1,3,2,1,1,3,1,0,2,1,1,0,3,1,4,0,2,1,1,0,1,3,1,0,1,1,1,0,2,1,1,2,1,1,2,0,1,3,8,1]},{i:7,m:7,data:[8,1,1,3,1,7,2,0,1,3,2,1,1,0,1,1,1,3,1,1,1,4,2,1,1,5,4,0,2,1,1,3,2,1,1,4,1,3,2,1,1,0,1,7,1,2,2,0,8,1]},{i:7,m:7,data:[8,1,1,3,1,9,1,0,1,7,1,11,2,1,1,6,1,8,1,5,1,3,1,0,2,1,1,9,1,1,1,8,1,1,1,6,2,1,1,3,1,0,1,10,1,1,1,0,2,1,1,2,2,0,1,8,1,3,8,1]},{i:7,m:7,data:[8,1,1,3,1,11,1,13,2,0,2,1,1,0,1,4,1,9,1,1,1,10,2,1,1,8,1,1,2,0,1,3,2,1,1,3,1,1,1,2,2,0,2,1,1,0,1,8,1,15,1,0,
1,3,8,1]},{i:7,m:7,data:[8,1,1,0,1,3,1,8,1,11,1,3,2,1,1,8,1,9,2,0,1,9,2,1,1,3,1,2,1,5,2,0,2,1,1,4,1,0,1,6,1,14,1,12,2,1,1,10,1,15,1,0,1,1,1,3,8,1]},{i:7,m:7,data:[8,1,1,3,1,11,1,15,1,0,1,3,2,1,1,9,1,0,1,10,1,1,1,0,2,1,1,14,1,8,1,6,1,14,1,4,2,1,1,0,1,8,1,7,1,9,1,0,2,1,1,3,1,5,1,8,1,3,1,2,8,1]},{i:7,m:7,data:[8,1,1,3,1,8,1,3,1,17,1,6,2,1,2,8,1,0,1,15,1,0,2,1,1,3,1,9,1,0,1,4,1,3,2,1,1,9,1,2,1,1,2,8,2,1,1,15,1,0,1,16,1,0,1,10,8,1]}];const pa=[[.9,.95,1],[.6,.8,1],[.05,.25,.6],[.15,.45,.8],[.33,.67,1]],qa=[[1,.9,.95],[1,.6,.8],[.6,.05,.25],[.8,.15,.45],[1,.33,.67]],ra=[[.95,.95,.95],[.8,.8,.8],[.3,.3,.3],[.46,.46,.46],[.67,.67,.67]];function P(a,b,c){return 0>b||0>c||b>=a.i||c>=a.m?1:a.data[c*a.i+b]}function Q(a,b,c,d,e){let g;if(null!=d&&(g=P(a,b,c),4<=g&&7>=g&&d==g-4))return!0;g=a.B[c*a.i+b];return e&&0>g?!0:0<a.B[c*a.i+b]}function R(a,b,c,d){a.B[c*a.i+b]=d}
function S(a,b,c,d,e,g){let f=[P(a,c-1,d)!=e,P(a,c,d-1)!=e,P(a,c+1,d)!=e,P(a,c,d+1)!=e];b.f(...g[4]);L(b,0,64*c,64*d,64,64);f[2]&&(b.f(...g[2]),L(b,0,64*c+51.2,64*d,12.8,64));f[3]&&(b.f(...g[3]),L(b,0,64*c,64*d+51.2,64,12.8),f[2]&&(b.f(...g[2]),L(b,1,64*c+51.2,64*d+51.2,-12.8,-12.8)));f[0]&&(b.f(...g[0]),L(b,0,64*c,64*d,12.8,64),f[3]&&(b.f(...g[3]),L(b,1,64*c,64*d+51.2,-12.8,12.8)));f[1]&&(b.f(...g[1]),L(b,0,64*c,64*d,64,12.8),f[0]&&(b.f(...g[0]),L(b,1,64*c,64*d,12.8,12.8)),f[2]&&(b.f(...g[2]),L(b,
1,64*c+51.2,64*d,-12.8,12.8)));const h=[0,1,1,0],k=[0,0,1,1],l=[-1,-1,1,1],n=[-1,1,1,-1];let p,q;for(let r=0;4>r;++r)p=h[r],q=k[r],f[r]||f[(r+1)%4]||P(a,c-1+2*p,d-1+2*q)==e||(b.f(...g[r]),L(b,1,64*c+51.2*p,64*d+51.2*q,12.8*l[r],12.8*n[r]),b.f(...g[(r+1)%4]),L(b,1,64*c+51.2*p,64*d+51.2*q,-12.8*l[r],-12.8*n[r]))}
function sa(a,b,c,d,e){c=64*(c+.5);d=64*(d+.5);b.f(.75,0,1);L(b,0,c-32*e,d-32*e,64*e,64*e);let g;for(let f=0;4>f;++f)g=1-(.25*f+.25*a.h)%1,b.f(.75*g,0,g),L(b,0,c-64*g/2*e,d-64*g/2*e,64*g*e,64*g*e)}
function ta(a,b,c,d){b=64*(b+.5);c=64*(c+.5)+8;d||(a.f(0,0,0,.25),a.push(),a.translate(b+2,c),a.rotate(Math.PI/12),D(a),L(a,3,0,0,26,18),a.pop());a.f(0,0,0);for(let e=1;0<=e;--e)0==e&&(d?a.f(.8,.15,.45):a.f(.6,.05,.25)),L(a,3,b,c,20+3*e,10+3*e),d||(L(a,0,b-20-3*e,c-16-3*e,2*(20+3*e),16+6*e),0==e&&a.f(1,.33,.67),L(a,3,b,c-16,20+3*e,10+3*e))}
function ua(a,b,c,d,e,g){b=64*(b+.5)+d;c=64*(c+.5)+e;a.push();a.translate(b,c);a.rotate(-Math.PI/6);D(a);for(c=1;c>=(g?1:0);--c){g?a.f(...g):1==c?a.f(0,0,0):a.f(1,.9,.2);L(a,3,0,-12,14+3*c,10+3*c);L(a,0,-5-3*c,-8-3*c,10+6*c,32+6*c);for(e=0;2>e;++e)L(a,0,5+3*c,6-3*c+12*e,10,6+6*c);0==c&&(a.f(0,0,0),L(a,3,0,-12,7,5))}a.pop()}
class va{constructor(a,b){a=oa[a-1];this.data=Array(a.i*a.m);let c=0;for(let g=0;g<a.data.length-1;g+=2){var d=a.data[g];var e=a.data[g+1];for(let f=0;f<d;++f)this.data[c++]=e}this.i=a.i;this.m=a.m;this.B=Array(a.i*a.m);this.B.fill(0);this.h=0;this.a=30;this.N=new B;this.g=this.b=0;for(a=0;a<this.m;++a)for(e=0;e<this.i;++e)switch(d=P(this,e,a),d){case 1:case 8:case 16:R(this,e,a,1);break;case 2:null==b.A&&(b.A=new xa(e,a));this.N.x=64*(e+.5);this.N.y=64*(a+.5);break;case 3:R(this,e,a,-1);d=b;d.h.push(new ya(e,
a));++d.K;break;case 12:case 13:case 14:case 15:R(this,e,a,2),b.L.push(new za(e,a,d-12))}}update(a,b){a&&(0<this.a&&(this.a-=1*b.step,this.a=Math.max(0,this.a)),this.h=(this.h+.025*b.step)%1);this.b=(this.b+b.step)%60;this.g=(this.g+.05*b.step)%(2*Math.PI)}};function Aa(a,b){if(!a.u)return!0;if(!a.D)return!1;0>=(a.J-=1*b.step)&&(a.D=!1,a.u=!1);return!0}function T(a,b){a.s&&(null==a.o&&(a.C-=b.step),0>=a.C&&(a.C=0,a.s=!1,a.c=a.target.clone()),b=a.C/30,a.a.x=64*(a.c.x*b+(1-b)*a.target.x),a.a.y=64*(a.c.y*b+(1-b)*a.target.y))}
class U{constructor(a,b){this.c=new B(a|0,b|0);this.a=new B(64*a,64*b);this.C=this.depth=0;this.target=this.c.clone();this.s=!1;this.u=!0;this.o=null;this.J=0;this.D=!1}finish(a,b){return V(b)?this.D||!this.u?!0:null!=this.o&&this.o.u||2!=P(a,this.c.x,this.c.y)?!1:(R(a,this.c.x,this.c.y,0),this.J=30,this.D=!0,Ba(b,this.a.x+32,this.a.y+32,6,this.depth,[1,1,1]),!0):!1}};class ya extends U{constructor(a,b){super(a,b);this.b=0;this.depth=this.a.y+32+16}update(a,b){Aa(this,b)||(null!=this.o&&(this.o.D?this.s||(this.c=this.target.clone(),this.target=this.o.target.clone(),this.s=!0,R(a,this.c.x,this.c.y,0)):!this.o.s||this.s||this.c.x==this.o.c.x&&this.c.y==this.o.c.y||2==a.B[this.o.c.y*a.i+this.o.c.x]||(this.target=this.o.c.clone(),this.s=!0,R(a,this.c.x,this.c.y,0),this.o.D||R(a,this.target.x,this.target.y,2)),this.s?(this.C=this.o.D?this.o.J:this.o.C,this.b=(1-this.C/
30)*(this.c.x%2==this.c.y%2==0?1:-1)):R(a,this.c.x,this.c.y,2)),T(this,b),this.depth=this.a.y+32+16)}v(a){const b=[6,3,0],c=[0,0,-2,-6],d=[0,0,-2,-6];var e=[[0,0,0],[.5,.45,.4],[.85,.8,.75],[1,1,1]];const g=[[0,0,0],[.8,.25,.15],[1,.5,.4],[1,.8,.8]];var f=this.a.x+32;let h=this.a.y+32+-8;e=this.o?e:g;if(this.u){this.D&&(a.I=I(this.J/30,1));a.f(0,0,0,.25);L(a,3,f,h+24,24,8);a.push();a.translate(f,h);a.rotate(Math.sin(this.b*Math.PI)*Math.PI/6);D(a);for(f=0;3>f;++f)a.f(...e[f]),L(a,5,c[f],d[f],22+b[f],
22+b[f]);a.f(...e[3]);L(a,3,c[3],d[3],10,10);a.pop();a.I=I(1,1)}}};function Ca(a,b){let c=a.c.x|0;a=a.c.y|0;return Q(b,c-1,a,1)&&Q(b,c+1,a,3)&&Q(b,c,a-1,2)&&Q(b,c,a+1,0)}
function Da(a,b,c,d){let e=a.c.x|0,g=a.c.y|0;if(!a.s){a.j=!1;var f=null;var h=P(b,a.c.x,a.c.y);if(4<=h&&7>=h)f=new B(a.c.x,a.c.y),f.x+=[0,1,0,-1][h-4],f.y+=[-1,0,1,0][h-4],Q(b,f.x,f.y)&&(f=null);else if(10==h){for(f=0;f<b.i*b.m;++f)10==b.data[f]||11==b.data[f]?b.data[f]=10==b.data[f]?11:10:2==b.B[f]||8!=b.data[f]&&9!=b.data[f]||(b.data[f]=8==b.data[f]?9:8,b.B[f]=!b.B[f]);f=null}h=null;null!=f||d?null!=f&&(e=f.x,g=f.y,a.j=!0):1==c.input.getKey(37)?(--e,h=1):1==c.input.getKey(39)?(++e,h=3):1==c.input.getKey(38)?
(--g,h=2):1==c.input.getKey(40)&&(++g,h=0);Q(b,e,g,h)||e==(a.c.x|0)&&g==(a.c.y|0)||(a.s=!0,a.C=30,a.target.x=e,a.target.y=g,R(b,a.c.x,a.c.y,0),R(b,e,g,2))}}
class xa extends U{constructor(a,b){super(a,b);this.g=this.K=this.b=this.h=0;this.j=!1}update(a,b){Aa(this,b)||(Da(this,a,b),T(this,b),a=2*Math.PI/30,this.s&&!this.j?(this.b+=a*b.step,this.g+=a*b.step,this.b%=2*Math.PI,this.g%=2*Math.PI,this.h=0):(this.g=this.b=0,this.h+=.05*b.step,this.b%=2*Math.PI),this.depth=this.a.y+32+18)}v(a){var b=Math.PI/16;const c=[.67,.4,.1],d=[[1,.7,0],[.8,.4,0]];if(this.u){var e=this.a.x+32,g=this.a.y+32;this.D&&(a.I=I(this.J/30,1));a.f(0,0,0,.25);L(a,3,e,g+-2+10+12,24,
7);var f=g+-12+10,h=4*Math.sin(this.g);for(let k=-1;1>=k;k+=2)a.f(0,0,0),L(a,2,e+10*k-1+1,f+h*k,20,-12),a.f(...c),L(a,2,e+10*k,f+h*k,16,-10);a.push();a.translate(e,g+-12+2*Math.sin(this.h));a.rotate(Math.sin(this.b)*b);D(a);a.f(0,0,0);L(a,0,-27,-23,54,46);a.f(...[.9,.9,.9]);L(a,0,-24,-20,48,40);for(b=-1;1>=b;b+=2)a.f(0,0,0),L(a,3,12*b,-6,10,10),a.f(),L(a,3,12*b+2,-8,3,3);for(b=0;2>b;++b)a.f(...d[b]),L(a,1,-16*(1-b),0,-16+32*b,16);a.pop();a.I=I(1,1)}}};class Ea{constructor(){this.c=new B;this.speed=new B;this.b=this.a=0;this.h=1;this.g=[1,1,1];this.scale=32;this.depth=0;this.u=!1}update(a){this.u&&(this.speed.y+=.2*a.step,this.speed.y=Math.min(4,this.speed.y),this.a+=this.speed.x/8*.25*a.step,0>=(this.b-=this.h*a.step)&&(this.u=!1),this.c.x+=this.speed.x*a.step,this.c.y+=this.speed.y*a.step)}v(a){this.u&&(a.push(),a.translate(this.c.x,this.c.y),a.rotate(this.a),D(a),a.f(...this.g,this.b/60),L(a,6,0,0,this.scale,this.scale),a.pop())}};function Fa(a,b,c,d,e){var g=Math.PI/16;const f=[-2,-2,2,2][a.b],h=[2,-2,-2,2][a.b];var k=a.s?a.C/30:0;g+=Math.abs(k-.5)/.5*(Math.PI/4-g);k=Math.sin(k*Math.PI)*Math.PI/6;a.c.x%2==a.c.y%2&&(k*=-1);b.push();b.translate(a.a.x+32+c,a.a.y+32+d);b.rotate(k+Math.PI/2*(a.b-1));b.scale(-1,1);D(b);e&&b.f(...e);for(a=1;0<=a;--a)for(e||(0==a?b.f(.8,.67,1):b.f(0,0,0)),c=0;2>c;++c)b.push(),b.rotate(g*(1-2*c)),D(b),1==a&&L(b,0,-27,-3*(1-c),54,3),L(b,7,-24*c-3*a*c,-24*c-3*a*c,24-48*c+3*a*(1-2*c),24-48*c+3*a*(1-2*
c)),b.pop();if(!e)for(e=0;2>e;++e)b.f(0,0,0),L(b,3,-12,10*(-1+2*e),7,7),b.f(),L(b,3,-12+f,10*(-1+2*e)+h,2.5,2.5);b.pop()}
class za extends U{constructor(a,b,c){super(a,b);this.b=c;this.o=1}update(a,b,c){this.s&&Q(b,this.target.x,this.target.y)&&(this.s=!1,this.target=this.c.clone());this.C=a.C;T(this,c);if(!this.s&&(R(b,this.c.x,this.c.y,2),a.s))a:{a=[0,1,0,-1];c=[-1,0,1,0];var d=[2,3,0,1];let e=this.c.x,g=this.c.y;e+=a[this.b];g+=c[this.b];if(Q(b,e,g,null,!0)){d=d[this.b];e=this.c.x+a[d];g=this.c.y+c[d];if(Q(b,e,g,null,!0))break a;this.b=d}this.target.x=e;this.target.y=g;this.s=!0;R(b,this.c.x,this.c.y,0)}}v(a){Fa(this,
a,0,0,[0,0,0,.25]);Fa(this,a,-2,-2)}};function V(a){return a.A.K==a.K}function Ba(a,b,c,d,e,g){let f=Math.random()*Math.PI*2,h=2*Math.PI/d;for(let u=0;u<d;++u){{let C;var k=a,l=b,n=c,p=4*Math.cos(f),q=4*Math.sin(f)-4,r=g,F=e;for(let y=0;y<k.a.length;++y)if(!(C=k.a[y]).u){k=C;k.c=new B(l,n);k.speed=new B(p,q);k.a=Math.random()*Math.PI*2;k.b=60;k.h=1;k.g=null==r?[1,1,1]:r;k.scale=10;k.depth=F;k.u=!0;break}}f+=h}}
function Ga(a){a.b=[];a.b.push(a.A);for(var b=0;b<a.h.length;++b)a.b.push(a.h[b]);for(b=0;b<a.a.length;++b)a.a[b].u&&a.b.push(a.a[b]);a.b.sort((c,d)=>c.depth-d.depth)}
class Ha{constructor(){this.A=null;this.h=[];this.L=[];this.g=[];this.a=Array(16);for(let a=0;a<this.a.length;++a)this.a[a]=new Ea;this.b=[];this.K=0}update(a,b,c){null!=this.A&&this.A.update(a,c);for(let h=0;h<this.h.length;++h){var d=this.h[h],e=this.A,g=this.g,f=a;null==d.o&&d.u&&e.c.x==d.c.x&&e.c.y==d.c.y&&(0!=g.length&&(g[g.length-1].o=d),d.o=e,g.push(d),++e.K,Ba(this,d.a.x+32,d.a.y+32,5,d.depth,[1,.25,.2]),R(f,d.c.x,d.c.y,2))}for(d=this.g.length-1;0<=d;--d)this.g[d].update(a,c);for(d=0;d<this.L.length;++d)this.L[d].update(this.A,
a,c);if(!(d=null==this.A||V(this)&&this.A.finish(a,this))){a:{d=this.A;if(!d.s&&Ca(d,a)&&(Da(d,a,null,!0),Ca(d,a))){d=!0;break a}d=!1}d=!d}if(d){for(b=this.g.length-1;0<=b;--b)this.g[b].finish(a,this);for(a=0;a<this.a.length;++a)this.a[a].update(c)}else W(b,1)}v(a){Ga(this);for(var b=0;b<this.L.length;++b)this.L[b].v(a);for(b=0;b<this.b.length;++b)this.b[b].v(a)}};function Ia(a,b,c,d,e,g,f,h){a.a=b;a.speed=c;a.g.r=d;a.g.S=e;a.g.R=g;a.b=60;null!=f&&(a.w=f);a.j=h?h:0;a.h=a.j;a.active=!0}function X(a){let b=a.b/60;a.a&&(b=1-b);return b}function Ja(a){if(.001>=a.j)return 0;let b=a.h/a.j;a.a&&(b=1-b);return b}
class Ka{constructor(){this.b=0;this.w=()=>{};this.g={r:0,S:0,R:0};this.active=!1;this.speed=1;this.a=!1;this.h=0;this.j=1}update(a){this.active&&!(0<(this.h-=1*a.step))&&0>=(this.b-=this.speed*a.step)&&(0==(this.a=!this.a)?(this.w(a),this.b+=60):(this.active=!1,this.b=0))}v(a){!this.active||0<this.h||(a.f(this.g.r,this.g.S,this.g.R,X(this)),L(a,0,0,0,a.viewport.x,a.viewport.y))}};const Y=[.33,.67,1];function W(a,b){Ia(a.a,!0,b?3-b:2,...Y,()=>{La(a,2==b?++a.id:0)},30*b);a.h=b}function La(a,b){null!=b&&0<b&&(a.id=b);a.g=new Ha;a.j=new va(a.id,a.g)}function Z(a,b,c,d,e){a.push();a.translate(b+16,c+8);a.rotate(e);D(a);a.f(0,0,0,.25);L(a,4,0,0,d,d);a.pop();a.push();a.translate(b,c);a.rotate(e);D(a);a.f(...[.5,.5,.5]);L(a,4,0,0,d,d);a.f(...[.75,.75,.75]);L(a,4,0,0,d-8,d-8);a.pop()}
class Ma{constructor(){this.id=7;La(this);this.H=this.b=0;this.a=new Ka;Ia(this.a,!1,1,...Y);this.w=this.h=0}update(a){var b=Math.PI/2/30;this.H+=.05*a.step;var c=this.g;c.A.s||c.A.D||!c.A.u||this.a.active?(b=this.b+b*(this.a.active?-1:1)*a.step,c=Math.PI/2,this.b=0>b?c- -b%c:b%c):this.b=0;this.a.active?(0<this.h&&(this.w=(this.w+.025*a.step)%(2*Math.PI)),this.a.update(a)):(this.j.update(V(this.g),a),this.g.update(this.j,this,a),b=this.g,0<b.g.length&&!b.g[0].u?W(this,2):2==a.input.getKey(82)&&W(this))}v(a){var b=
Math.PI/3;a.clear(...Y);O(a,!1);var c=1,d=1,e=null,g=null,f=null;this.a.active&&(2==this.h&&this.a.a&&(e=this.j.N.x,g=this.j.N.y,d=8,f=-b*X(this.a)),c=X(this.a),c=1+c*d*.25*(this.a.a?1:-1));b=this.j;d=64*b.m;var h=a.i/a.m*d;t(a.P,h,d);a.viewport.x=h;a.viewport.y=d;a.G=!1;d=64*b.i/2;b=64*b.m/2;h=a.viewport.x/2-d;null!=e&&(d=e);null!=g&&(b=g);a.translate(h,0);a.translate(d,b);null!=f&&a.rotate(f);a.scale(c,c);a.translate(-d,-b);D(a);c=this.j;b=V(this.g);for(e=0;e<c.m;++e)for(g=0;g<c.i;++g)switch(f=
P(c,g,e),f){case 1:S(c,a,g,e,1,pa);break;case 8:S(c,a,g,e,8,qa);break;case 16:f=a;d=64*(g+.5);h=64*(e+.5);S(c,f,g,e,-1,ra);f.f(0,0,0);L(f,3,d,h+-8,8,8);L(f,2,d,h+4,12,16);break;default:d=a;h=g;var k=e;h%2==k%2?d.f(.9,.75,.5):d.f(.8,.55,.3);L(d,0,64*h,64*k,64,64);if(2==f){var l=c.a/30;if(b&&0>=l)sa(c,a,g,e,1);else if(!b||0<l)d=a,h=g,k=e,d.push(),d.translate(64*(h+.5),64*(k+.5)),d.rotate(Math.PI/4),D(d),d.f(.67,0,0),L(d,0,-25.6,-8,51.2,16),L(d,0,-8,-25.6,16,51.2),d.pop(),sa(c,a,g,e,1-l)}else if(4<=
f&&7>=f){k=c;d=a;l=g;var n=e,p=f-4;h=[[.67,1,.67],[0,.67,0]];d.push();d.translate(64*(l+.5),64*(n+.5));d.rotate(p*Math.PI/2);D(d);k=30>=k.b?0:1;for(l=0;2>l;++l)d.f(...[0,.33,0]),L(d,2,0,-14+26*l,36,14),d.f(...h[(l+k)%2]),L(d,2,0,-14+26*l,24,10);d.pop()}else if(9==f)for(d=a,h=64*g,k=64*e,d.f(.6,.05,.25),l=0;2>l;++l)for(n=0;2>=n;++n)L(d,0,h+24*n,k+56*l,16,8),L(d,0,h+56*l,k+24*n,8,16);else 11==f&&ta(a,g,e,!0);{var q;d=c;h=a;k=g;l=e;n=[1!=d.B[l*d.i+(k-1)],1!=d.B[(l-1)*d.i+k],1!=d.B[l*d.i+(k+1)],1!=d.B[(l+
1)*d.i+k]];h.f(0,0,0,.25);p=1==d.B[(l-1)*d.i+(k-1)];var r=q=0;n[0]?n[1]?p&&L(h,0,64*k,64*l,16,16):(n[0]&&!p&&(q=3),L(h,n[0]&&!p?1:0,64*k-q,3+64*l,-16,-13),L(h,0,64*(k+.25)-q,3+64*l,48+q,13)):(n[1]&&!p&&(r=1,q=3),L(h,0,3+64*k,64*(l+.25)-q,13,48+q),L(h,r,3+64*k,64*l-q,13,16),n[1]||L(h,0,64*(k+.25),64*l,48,16));h.f(0,0,0);n[0]||L(h,0,64*k,64*l,3,64);n[1]||L(h,0,64*k,64*l,64,3);n[2]||L(h,0,64*(k+1)-3,64*l,3,64);n[3]||L(h,0,64*k,64*(l+1)-3,64,3);r=[0,1,1,0];const F=[0,0,1,1];for(let u=0;4>u;++u)q=r[u],
p=F[u],n[u]&&n[(u+1)%4]&&1==d.B[(l-1+2*p)*d.i+(k-1+2*q)]&&L(h,0,64*k+61*q,64*l+61*p,3,3)}10==f?ta(a,g,e,!1):17==f&&(f=a,d=g,h=e,k=4+2*Math.sin(c.g+(d+h)*Math.PI/c.i),ua(f,d,h,0,0,[0,0,0,.25]),ua(f,d,h,-k,-k))}this.g.v(a);m(a.F);a.G=!1;c=a.i/a.m*720;t(a.P,c,720);a.viewport.x=c;a.viewport.y=720;a.G=!1;D(a);this.a.v(a);if(this.a.active&&0<this.h){c=["STUCK","STAGE CLEAR"][this.h-1];b=[[1,.4,0],[1,1,.5]][this.h-1];e=a.viewport.y/2;g=a.viewport.x/2-72*(c.length-1)/2;O(a,!0);f=X(this.a);this.a.a&&(f=Ja(this.a));
d=1/c.length;for(k=0;k<c.length;++k)for(l=(f-d*(this.a.a?k:c.length-1-k))/d,l=I(l,1),h=-64+64*l+-16*Math.sin(this.w+k*Math.PI*2/c.length),a.I=I(l,1),l=1;0<=l;--l)0==l?a.f(...b):a.f(0,0,0,.25),M(a,c.charAt(k),g+72*k+8*l,e-48+h+8*l,0,96,96);O(a,!1);a.I=I(1,1)}Z(a,0,0,128,this.b);Z(a,a.viewport.x,0,96,-this.b);Z(a,0,a.viewport.y,96,-this.b);Z(a,a.viewport.x,a.viewport.y,128,this.b);c=["STAGE "+String(this.id),"Password: NONE"];b=[64,48];e=[6,4];g=[Math.PI/3,Math.PI/6];f=[6,4];d=[6,4];O(a,!0);for(l=0;2>
l;++l)for(k=2==this.h&&this.a.active?Math.max(X(this.a),Ja(this.a))*(e[l]+b[l]):0,n=1;0<=n;--n)h=0==l?36:a.viewport.y-4-32,h-=b[l]/2-n*d[l],h-=(1-2*l)*k,1==n?a.f(0,0,0,.25):a.f(1,1,.5),M(a,c[l],a.viewport.x/2+n*f[l],h,-16,b[l],b[l],g[l],e[l],this.H)}};window.onload=()=>{let a=new na;var b=new Ma(a.g.a);a.w.game=b;a.a=b;a.frameRate=60;a.h.step=60/a.frameRate;a.target=1E3/a.frameRate;ma(a,0)};
