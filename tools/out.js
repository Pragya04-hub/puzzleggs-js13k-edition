'use strict';class aa{constructor(a,b,c){this.a=a;this.i=b;this.l=c}bind(a){a.bindTexture(a.TEXTURE_2D,this.a)}};function l(a){for(let b=0;3>b;++b)for(let c=0;3>c;++c)a.h[3*b+c]=b==c?1:0}function r(a,b,c){l(a);a.h[0]=2/(b-0);a.h[2]=-(b+0)/(b-0);a.h[4]=2/(0-c);a.h[5]=-(0+c)/(0-c);a.h[8]=1}function v(a){let b=new y;for(let c=0;3>c;++c)for(let d=0;3>d;++d)b.h[3*d+c]=a.h[3*c+d];return b}
class y{constructor(){this.h=new Float32Array(9);l(this)}multiply(a){let b=new y;for(var c=0;3>c;++c)for(var d=0;3>d;++d)b.h[3*c+d]=0;for(c=0;3>c;++c)for(d=0;3>d;++d)for(let g=0;3>g;++g)b.h[3*c+d]+=this.h[3*c+g]*a.h[3*g+d];return b}translate(a,b){l(this);this.h[2]=a;this.h[5]=b}rotate(a){let b=Math.cos(a);a=Math.sin(a);l(this);this.h[0]=b;this.h[1]=-a;this.h[3]=a;this.h[4]=b}clone(){let a=new y;for(let b=0;9>b;++b)a.h[b]=this.h[b];return a}};function z(a,b,c,d,g){let e=a.b;e.uniform2f(a.w,b,c);e.uniform2f(a.A,d,g)}function E(a){var b=a.b;b.useProgram(a.a);b.uniform1i(a.B,0);z(a,0,0,1,1);b=a.b;b.uniform2f(a.f,0,0);b.uniform2f(a.g,1,1);b=new y;a.b.uniformMatrix3fv(a.j,!1,v(b).h)}
class F{constructor(a,b,c){this.b=a;this.a=null;{let d=this.b;b=this.createShader(b,d.VERTEX_SHADER);c=this.createShader(c,d.FRAGMENT_SHADER);this.a=d.createProgram();d.attachShader(this.a,b);d.attachShader(this.a,c);c=this.b;c.bindAttribLocation(this.a,0,"v");c.bindAttribLocation(this.a,1,"uvp");d.linkProgram(this.a);if(!d.getProgramParameter(this.a,d.LINK_STATUS))throw"Shader error: "+d.getProgramInfoLog(this.a);}this.j=a.getUniformLocation(this.a,"transform");this.m=a.getUniformLocation(this.a,
"color");this.B=a.getUniformLocation(this.a,"t0");this.w=a.getUniformLocation(this.a,"pos");this.A=a.getUniformLocation(this.a,"size");this.f=a.getUniformLocation(this.a,"texPos");this.g=a.getUniformLocation(this.a,"texSize")}createShader(a,b){let c=this.b;b=c.createShader(b);c.shaderSource(b,a);c.compileShader(b);if(!c.getShaderParameter(b,c.COMPILE_STATUS))throw"Shader error:\n"+c.getShaderInfoLog(b);return b}c(a,b,c,d){this.b.uniform4f(this.m,a,b,c,d)}};class G{constructor(a,b,c,d){this.g=d.length;this.f=a.createBuffer();this.b=a.createBuffer();this.a=a.createBuffer();a.bindBuffer(a.ARRAY_BUFFER,this.f);a.bufferData(a.ARRAY_BUFFER,new Float32Array(b),a.STATIC_DRAW);a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,this.a);a.bufferData(a.ELEMENT_ARRAY_BUFFER,new Uint16Array(d),a.STATIC_DRAW);a.bindBuffer(a.ARRAY_BUFFER,this.b);a.bufferData(a.ARRAY_BUFFER,new Float32Array(c),a.STATIC_DRAW)}bind(a){a.bindBuffer(a.ARRAY_BUFFER,this.f);a.vertexAttribPointer(0,2,a.FLOAT,
a.G,0,0);a.bindBuffer(a.ARRAY_BUFFER,this.b);a.vertexAttribPointer(1,2,a.FLOAT,a.G,0,0);a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,this.a)}s(a){a.drawElements(a.TRIANGLES,this.g,a.UNSIGNED_SHORT,0)}};class J{constructor(a,b){this.x=null==a?0:a;this.y=null==b?0:b}clone(){return new J(this.x,this.y)}};function L(a){if(null!=a.b){a.o||(a.w=a.D.multiply(a.C.multiply(a.u)),a.o=!0);var b=a.b;b.b.uniformMatrix3fv(b.j,!1,v(a.w).h)}}
class ba{constructor(){this.D=new y;this.C=new y;this.u=new y;this.w=new y;this.g=new y;this.viewport=new J;this.o=!1;this.b=null;this.j=[]}translate(a,b){this.g.translate(a,b);this.u=this.u.multiply(this.g);this.o=!1}rotate(a){this.g.rotate(a);this.u=this.u.multiply(this.g);this.o=!1}push(){this.j.push(this.u.clone());if(64<=this.j.length)throw"Stack overflow!";}pop(){this.u=this.j.pop().clone();this.o=!1;L(this)}};function M(a,b,c,d,g){b=null!=b?Math.min(b,32):32;let e=2*Math.PI/32,f,h=[],k=[],n=0,w=!1,m=1;for(let x=0;x<b;++x)c&&++n>=c&&(m=(w=!w)?1+d:1,n-=c),f=e*x,g?(h.push(g*Math.cos(f),g*Math.sin(f),Math.cos(f)*m,Math.sin(f)*m,Math.cos(f+e)*m,Math.sin(f+e)*m),h.push(g*Math.cos(f),g*Math.sin(f),g*Math.cos(f+e),g*Math.sin(f+e),Math.cos(f+e)*m,Math.sin(f+e)*m)):h.push(0,0,Math.cos(f)*m,Math.sin(f)*m,Math.cos(f+e)*m,Math.sin(f+e)*m);b=96;g&&(b*=2);for(g=0;g<b;++g)k.push(g);return new G(a.a,h,h,k)}
class ca{constructor(a){this.a=a}};function N(a){var b=window.innerWidth,c=window.innerHeight;a.f.width=b;a.f.height=c;a.a.viewport(0,0,b,c);a.i=a.f.width;a.l=a.f.height;a.top=-1;a.left=-a.i/a.l}function O(a,b,c,d,g,e,f){let h=a.a;null!=d&&z(a.b,d,g,e,f);a.B!=b&&(b.bind(h),a.B=b);null!=c&&c.bind(h);b.s(h)}function P(a,b,c,d,g,e){0>g&&(c-=g);0>e&&(d-=e);O(a,a.m[Math.max(0,Math.min(b|0,a.m.length-1))],null,c,d,g,e)}function Q(a,b){a.b=b?a.F:a.H;E(a.b);a.c(1,1,1,1);L(a)}
class da extends ba{constructor(){super();var a=document.createElement("div");a.setAttribute("style","position: absolute; top: 0; left: 0; z-index: -1");this.f=document.createElement("canvas");this.f.width=window.innerWidth;this.f.height=window.innerHeight;this.f.setAttribute("style","position: absolute; top: 0; left: 0; z-index: -1");a.appendChild(this.f);document.body.appendChild(a);this.a=null;a=this.a=this.f.getContext("webgl",{alpha:!1});if(null===a)throw"Failed to initialize WebGL.";a.activeTexture(a.TEXTURE0);
a.disable(a.DEPTH_TEST);a.enable(a.BLEND);a.blendFuncSeparate(a.SRC_ALPHA,a.ONE_MINUS_SRC_ALPHA,a.ONE,a.ONE_MINUS_SRC_ALPHA);a.enableVertexAttribArray(0);a.enableVertexAttribArray(1);a=new ca(this.a);this.m=[new G(a.a,[0,0,1,0,1,1,0,1],[0,0,1,0,1,1,0,1],[0,1,2,2,3,0]),new G(a.a,[0,0,1,1,0,1],[0,0,1,1,0,1],[0,1,2]),new G(a.a,[0,-1,.71,.71,-.71,.71],[0,0,1,1,0,1],[0,1,2]),M(a),M(a,null,2,.25,.33)];this.H=new F(this.a,"\nattribute vec2 v;\nattribute vec2 uvp;\n   \nuniform mat3 transform;\n\nuniform vec2 pos;\nuniform vec2 size;\n\nvarying vec2 uv;\n   \nvoid main() {\n\n    vec3 op = transform * vec3(v * size + pos, 1);\n    gl_Position = vec4(op, 1);\n    uv = uvp;\n}",
"\nprecision mediump float;\n \nuniform sampler2D t0;\nuniform vec4 color;\n\nuniform vec2 texPos;\nuniform vec2 texSize;\n\nvarying vec2 uv;\n\nvoid main() {\n\n    gl_FragColor = color;\n}\n");this.b=this.F=new F(this.a,"\nattribute vec2 v;\nattribute vec2 uvp;\n   \nuniform mat3 transform;\n\nuniform vec2 pos;\nuniform vec2 size;\n\nvarying vec2 uv;\n   \nvoid main() {\n\n    vec3 op = transform * vec3(v * size + pos, 1);\n    gl_Position = vec4(op, 1);\n    uv = uvp;\n}","\nprecision mediump float;\n \nuniform sampler2D t0;\nuniform vec4 color;\n\nuniform vec2 texPos;\nuniform vec2 texSize;\n\nvarying vec2 uv;\n\nvoid main() {\n      \n    const float DELTA = 0.001;\n    vec2 tex = uv;    \n    tex.x *= texSize.x;\n    tex.y *= texSize.y;\n    tex += texPos;\n    vec4 res = color * texture2D(t0, tex);\n    if(res.a <= DELTA) {\n        discard;\n    }\n    gl_FragColor = res;\n}\n");
E(this.b);{a=document.createElement("canvas");a.width=1024;a.height=1024;var b=a.getContext("2d");b.font="56px sans-serif";b.textAlign="center";let g;for(let e=33;123>e;++e){var c=e%16;g=e/16|0;b.fillStyle="#000000";for(var d=-3;3>=d;++d)for(let f=-3;3>=f;++f)if(d!=f||0!=d)for(let h=-2;2>=h;++h)b.fillText(String.fromCharCode(e),64*c+32+h+d,64*g+48+f);b.fillStyle="#FFFFFF";for(d=-2;2>=d;++d)b.fillText(String.fromCharCode(e),64*c+32+d,64*g+48)}b=this.a;c=b.createTexture();b.bindTexture(b.TEXTURE_2D,
c);b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MIN_FILTER,b.LINEAR);b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MAG_FILTER,b.LINEAR);b.texImage2D(b.TEXTURE_2D,0,b.RGBA,b.RGBA,b.UNSIGNED_BYTE,a);a.remove();this.A=new aa(c,1024,1024)}this.B=null;N(this)}clear(a,b,c){let d=this.a;d.clearColor(a,b,c,1);d.clear(d.COLOR_BUFFER_BIT)}c(a,b,c,d){null==a&&(a=1);null==b&&(b=1);null==c&&(c=1);null==d&&(d=1);this.b.c(a,b,c,d)}};class ea{constructor(){this.keys={};window.addEventListener("keydown",a=>{a.preventDefault();a=a.keyCode;1!=this.keys[a]&&(this.keys[a]=2)});window.addEventListener("keyup",a=>{a.preventDefault();a=a.keyCode;0!=this.keys[a]&&(this.keys[a]=3)})}update(){for(let a in this.keys)2==this.keys[a]?this.keys[a]=1:3==this.keys[a]&&(this.keys[a]=0)}getKey(a){return this.keys[a]|0}};function R(a,b){a.b+=b-a.j;let c=Math.floor(a.b/a.target)|0,d=0<c;5<c&&(a.b=5*a.target,c=5);for(;0<c--;)null!=a.a&&null!=a.a.update&&a.a.update(a.g),a.g.input.update(),a.b-=a.target;d&&null!=a.a&&null!=a.a.s&&a.a.s(a.f);a.j=b;window.requestAnimationFrame(g=>R(a,g))}class fa{constructor(){this.m=[];this.a=null;this.j=this.b=0;this.frameRate=30;this.target=0;this.g={I:this,input:new ea};this.f=new da(128,96);window.addEventListener("resize",()=>N(this.f))}};const ha=[{i:8,l:8,data:[9,1,1,0,1,1,1,3,3,0,2,1,1,0,2,1,2,0,3,1,4,0,1,3,1,0,2,1,2,0,1,1,1,0,1,1,1,0,2,1,1,0,1,3,4,0,2,1,1,3,1,1,1,0,1,2,1,1,1,3,9,1]}];function S(a,b,c){return 0>b||0>c||b>=a.i||c>=a.l?1:a.data[c*a.i+b]}class ia{constructor(a,b){a=ha[a-1];this.data=Array(a.i*a.l);let c=0;for(let e=0;e<a.data.length-1;e+=2){var d=a.data[e];var g=a.data[e+1];for(let f=0;f<d;++f)this.data[c++]=g}this.i=a.i;this.l=a.l;for(g=0;g<this.l;++g)for(d=0;d<this.i;++d)switch(a=S(this,d,g),a){case 2:null==b.v&&(b.v=new ja(d,g))}}};class ja{constructor(a,b){this.a=new J(a|0,b|0);this.m=new J(64*a,64*b);this.j=0;this.target=this.a.clone();this.g=!1;this.f=this.b=0}update(a,b){{let c=this.a.x|0,d=this.a.y|0;this.g||(1==b.input.getKey(37)?--c:1==b.input.getKey(39)?++c:1==b.input.getKey(38)?--d:1==b.input.getKey(40)&&++d,[1].includes(S(a,c,d))||c==(this.a.x|0)&&d==(this.a.y|0)||(this.g=!0,this.j=30,this.target.x=c,this.target.y=d))}this.g&&(0>=(this.j-=b.step)&&(this.j=0,this.g=!1,this.a=this.target.clone()),a=this.j/30,this.m.x=
64*(this.a.x*a+(1-a)*this.target.x),this.m.y=64*(this.a.y*a+(1-a)*this.target.y));a=2*Math.PI/30;this.g?(this.b+=a*b.step,this.f+=a*b.step,this.b%=2*Math.PI,this.f%=2*Math.PI):this.f=this.b=0}s(a){var b=Math.PI/16;const c=[.67,.4,.1],d=[[1,.7,0],[.8,.4,0]];let g=this.m.x+32,e=this.m.y+32;a.c(0,0,0,.25);P(a,3,g,e+-2+10+14,24,8);let f=e+-12+10,h=4*Math.sin(this.f);for(let k=-1;1>=k;k+=2)a.c(0,0,0),P(a,2,g+10*k-1+1,f+h*k,20,-12),a.c(...c),P(a,2,g+10*k,f+h*k,16,-10);a.push();a.translate(g,e+-12);a.rotate(Math.sin(this.b)*
b);L(a);a.c(0,0,0);P(a,0,-27,-23,54,46);a.c(...[.9,.9,.9]);P(a,0,-24,-20,48,40);for(b=-1;1>=b;b+=2)a.c(0,0,0),P(a,3,12*b,-6,10,10),a.c(),P(a,3,12*b+2,-8,3,3);for(b=0;2>b;++b)a.c(...d[b]),P(a,1,-16*(1-b),0,-16+32*b,16);a.pop()}};class ka{constructor(){this.v=null}update(a,b){null!=this.v&&this.v.update(a,b)}s(a){null!=this.v&&this.v.s(a)}};const la=[.33,.67,1];function T(a,b,c,d,g){a.push();a.translate(b+16,c+8);a.rotate(g);L(a);a.c(0,0,0,.25);P(a,4,0,0,d,d);a.pop();a.push();a.translate(b,c);a.rotate(g);L(a);a.c(...[.5,.5,.5]);P(a,4,0,0,d,d);a.c(...[.75,.75,.75]);P(a,4,0,0,d-8,d-8);a.pop()}
class ma{constructor(){this.b=new ka;this.f=new ia(1,this.b);this.g=this.a=0}update(a){const b=Math.PI/2/30;this.b.update(this.f,a);this.a=this.b.v.g?(this.a+b*a.step)%(Math.PI/2):0;this.g+=.05*a.step}s(a){a.clear(...la);Q(a,!1);var b=this.f,c=64*b.l,d=a.i/a.l*c;r(a.D,d,c);a.viewport.x=d;a.viewport.y=c;a.o=!1;b=a.viewport.x/2-64*b.i/2;l(a.C);a.o=!1;null!=b&&a.C.translate(b,0);L(a);b=this.f;for(c=0;c<b.l;++c)for(d=0;d<b.i;++d){var g=S(b,d,c);switch(g){case 1:g=b;var e=a,f=d,h=c,k=[[.9,.95,1],[.6,.8,
1],[.05,.25,.6],[.15,.45,.8],[.33,.67,1]],n=[1!=S(g,f-1,h),1!=S(g,f,h-1),1!=S(g,f+1,h),1!=S(g,f,h+1)];e.c(...k[4]);P(e,0,64*f,64*h,64,64);n[2]&&(e.c(...k[2]),P(e,0,64*f+51.2,64*h,12.8,64));n[3]&&(e.c(...k[3]),P(e,0,64*f,64*h+51.2,64,12.8),n[2]&&(e.c(...k[2]),P(e,1,64*f+51.2,64*h+51.2,-12.8,-12.8)));n[0]&&(e.c(...k[0]),P(e,0,64*f,64*h,12.8,64),n[3]&&(e.c(...k[3]),P(e,1,64*f,64*h+51.2,-12.8,12.8)));n[1]&&(e.c(...k[1]),P(e,0,64*f,64*h,64,12.8),n[0]&&(e.c(...k[0]),P(e,1,64*f,64*h,12.8,12.8)),n[2]&&(e.c(...k[2]),
P(e,1,64*f+51.2,64*h,-12.8,12.8)));var w=[0,1,1,0],m=[0,0,1,1],x=[-1,-1,1,1],t=[-1,1,1,-1];for(var p=0;4>p;++p){var u=w[p];var q=m[p];n[p]||n[(p+1)%4]||1==S(g,f-1+2*u,h-1+2*q)||(e.c(...k[p]),P(e,1,64*f+51.2*u,64*h+51.2*q,12.8*x[p],12.8*t[p]),e.c(...k[(p+1)%4]),P(e,1,64*f+51.2*u,64*h+51.2*q,-12.8*x[p],-12.8*t[p]))}break;default:for(g=b,e=a,f=d,h=c,q=[1!=S(g,f-1,h),1!=S(g,f,h-1),1!=S(g,f+1,h),1!=S(g,f,h+1)],f%2==h%2?e.c(.9,.75,.5):e.c(.8,.55,.3),P(e,0,64*f,64*h,64,64),e.c(0,0,0,.25),u=1==S(g,f-1,h-
1),n=k=0,q[0]?q[1]?u&&P(e,0,64*f,64*h,16,16):(q[0]&&!u&&(k=3),P(e,q[0]&&!u?1:0,64*f-k,3+64*h,-16,-13),P(e,0,64*(f+.25)-k,3+64*h,48+k,13)):(q[1]&&!u&&(n=1,k=3),P(e,0,3+64*f,64*(h+.25)-k,13,48+k),P(e,n,3+64*f,64*h-k,13,16),q[1]||P(e,0,64*(f+.25),64*h,48,16)),e.c(0,0,0),q[0]||P(e,0,64*f,64*h,3,64),q[1]||P(e,0,64*f,64*h,64,3),q[2]||P(e,0,64*(f+1)-3,64*h,3,64),q[3]||P(e,0,64*f,64*(h+1)-3,64,3),n=[0,1,1,0],w=[0,0,1,1],m=0;4>m;++m)k=n[m],u=w[m],q[m]&&q[(m+1)%4]&&1==S(g,f-1+2*k,h-1+2*u)&&P(e,0,64*f+61*k,
64*h+61*u,3,3)}}this.b.s(a);l(a.u);a.o=!1;l(a.C);a.o=!1;b=a.i/a.l*720;r(a.D,b,720);a.viewport.x=b;a.viewport.y=720;a.o=!1;L(a);T(a,0,0,128,this.a);T(a,a.viewport.x,0,96,-this.a);T(a,0,a.viewport.y,96,-this.a);T(a,a.viewport.x,a.viewport.y,128,this.a);u=["STAGE 1","Password: NONE"];k=[64,48];n=[6,4];w=[Math.PI/3,Math.PI/6];m=[6,4];x=[6,4];Q(a,!0);for(t=0;2>t;++t)for(p=1;0<=p;--p){var A=0==t?36:a.viewport.y-4-32;A-=k[t]/2-p*x[t];1==p?a.c(0,0,0,.25):a.c(1,1,.5);{b=a;c=u[t];d=a.viewport.x/2+p*m[t];g=
k[t];e=k[t];f=w[t];h=n[t];q=this.g;let B=b.A.i/16,H,U=A,V=g/64,na=e/64;H=d-=c.length/2*(B+-16)*V;let W=0;for(let I=0;I<c.length;++I){var C=c.charCodeAt(I);if(10==C)H=d,U+=(B+0)*na;else{null!=f&&(W=Math.sin(q+I*f)*h);A=b;var D=b.A,oa=C%16*B;C=(C/16|0)*B;var X=B,Y=B;z(A.b,H,U+W,g,e);{var K=A.b;X/=D.i;Y/=D.l;let Z=K.b;Z.uniform2f(K.f,oa/D.i,C/D.l);Z.uniform2f(K.g,X,Y)}O(A,A.m[0],D);H+=(B+-16)*V}}}}}};window.onload=()=>{let a=new fa;var b=new ma(a.f.a);a.m.game=b;a.a=b;a.frameRate=60;a.g.step=60/a.frameRate;a.target=1E3/a.frameRate;R(a,0)};
