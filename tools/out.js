'use strict';class aa{constructor(a,b,d){this.a=a;this.i=b;this.o=d}bind(a){a.bindTexture(a.TEXTURE_2D,this.a)}};function m(a){for(let b=0;3>b;++b)for(let d=0;3>d;++d)a.j[3*b+d]=b==d?1:0}function v(a,b,d){m(a);a.j[0]=2/(b-0);a.j[2]=-(b+0)/(b-0);a.j[4]=2/(0-d);a.j[5]=-(0+d)/(0-d);a.j[8]=1}function w(a){let b=new y;for(let d=0;3>d;++d)for(let c=0;3>c;++c)b.j[3*c+d]=a.j[3*d+c];return b}
class y{constructor(){this.j=new Float32Array(9);m(this)}multiply(a){let b=new y;for(var d=0;3>d;++d)for(var c=0;3>c;++c)b.j[3*d+c]=0;for(d=0;3>d;++d)for(c=0;3>c;++c)for(let e=0;3>e;++e)b.j[3*d+c]+=this.j[3*d+e]*a.j[3*e+c];return b}translate(a,b){m(this);this.j[2]=a;this.j[5]=b}scale(a,b){m(this);this.j[0]=a;this.j[4]=b}rotate(a){let b=Math.cos(a);a=Math.sin(a);m(this);this.j[0]=b;this.j[1]=-a;this.j[3]=a;this.j[4]=b}clone(){let a=new y;for(let b=0;9>b;++b)a.j[b]=this.j[b];return a}};function z(a,b,d,c,e){let h=a.b;h.uniform2f(a.H,b,d);h.uniform2f(a.L,c,e)}function A(a){var b=a.b;b.useProgram(a.a);b.uniform1i(a.N,0);z(a,0,0,1,1);b=a.b;b.uniform2f(a.c,0,0);b.uniform2f(a.f,1,1);b=new y;a.b.uniformMatrix3fv(a.l,!1,w(b).j)}
class C{constructor(a,b,d){this.b=a;this.a=null;{let c=this.b;b=this.createShader(b,c.VERTEX_SHADER);d=this.createShader(d,c.FRAGMENT_SHADER);this.a=c.createProgram();c.attachShader(this.a,b);c.attachShader(this.a,d);d=this.b;d.bindAttribLocation(this.a,0,"v");d.bindAttribLocation(this.a,1,"uvp");c.linkProgram(this.a);if(!c.getProgramParameter(this.a,c.LINK_STATUS))throw"Shader error: "+c.getProgramInfoLog(this.a);}this.l=a.getUniformLocation(this.a,"transform");this.u=a.getUniformLocation(this.a,
"color");this.N=a.getUniformLocation(this.a,"t0");this.H=a.getUniformLocation(this.a,"pos");this.L=a.getUniformLocation(this.a,"size");this.c=a.getUniformLocation(this.a,"texPos");this.f=a.getUniformLocation(this.a,"texSize")}createShader(a,b){let d=this.b;b=d.createShader(b);d.shaderSource(b,a);d.compileShader(b);if(!d.getShaderParameter(b,d.COMPILE_STATUS))throw"Shader error:\n"+d.getShaderInfoLog(b);return b}h(a,b,d,c){this.b.uniform4f(this.u,a,b,d,c)}};class D{constructor(a,b){this.x=null==a?0:a;this.y=null==b?0:b}clone(){return new D(this.x,this.y)}};function E(a){if(null!=a.b){a.G||(a.H=a.O.multiply(a.D),a.G=!0);var b=a.b;b.b.uniformMatrix3fv(b.l,!1,w(a.H).j)}}
class ba{constructor(){this.O=new y;this.D=new y;this.H=new y;this.f=new y;this.viewport=new D;this.G=!1;this.b=null;this.l=[]}translate(a,b){this.f.translate(a,b);this.D=this.D.multiply(this.f);this.G=!1}scale(a,b){this.f.scale(a,b);this.D=this.D.multiply(this.f);this.G=!1}rotate(a){this.f.rotate(a);this.D=this.D.multiply(this.f);this.G=!1}push(){this.l.push(this.D.clone());if(64<=this.l.length)throw"Stack overflow!";}pop(){this.D=this.l.pop().clone();this.G=!1;E(this)}};class G{constructor(a,b,d,c){this.f=c.length;this.c=a.createBuffer();this.b=a.createBuffer();this.a=a.createBuffer();a.bindBuffer(a.ARRAY_BUFFER,this.c);a.bufferData(a.ARRAY_BUFFER,new Float32Array(b),a.STATIC_DRAW);a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,this.a);a.bufferData(a.ELEMENT_ARRAY_BUFFER,new Uint16Array(c),a.STATIC_DRAW);a.bindBuffer(a.ARRAY_BUFFER,this.b);a.bufferData(a.ARRAY_BUFFER,new Float32Array(d),a.STATIC_DRAW)}bind(a){a.bindBuffer(a.ARRAY_BUFFER,this.c);a.vertexAttribPointer(0,2,a.FLOAT,
a.U,0,0);a.bindBuffer(a.ARRAY_BUFFER,this.b);a.vertexAttribPointer(1,2,a.FLOAT,a.U,0,0);a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,this.a)}B(a){a.drawElements(a.TRIANGLES,this.f,a.UNSIGNED_SHORT,0)}};function H(a,b,d,c,e){b=null!=b?Math.min(b,32):32;let h=2*Math.PI/32,f,g=[],k=[],l=0,p=!1,n=1;for(let t=0;t<b;++t)d&&++l>=d&&(n=(p=!p)?1+c:1,l-=d),f=h*t,e?(g.push(e*Math.cos(f),e*Math.sin(f),Math.cos(f)*n,Math.sin(f)*n,Math.cos(f+h)*n,Math.sin(f+h)*n),g.push(e*Math.cos(f),e*Math.sin(f),e*Math.cos(f+h),e*Math.sin(f+h),Math.cos(f+h)*n,Math.sin(f+h)*n)):g.push(0,0,Math.cos(f)*n,Math.sin(f)*n,Math.cos(f+h)*n,Math.sin(f+h)*n);b=96;e&&(b*=2);for(e=0;e<b;++e)k.push(e);return new G(a.a,g,g,k)}
function ca(a,b){var d;null==d&&(d=2*Math.PI);let c=d/24;d=[];let e=[],h,f;for(let g=0;24>g;++g)h=b(c*g),f=b(c*(g+1)),d.push(h[0],h[1],f[0],f[1],0,0);for(b=0;72>b;++b)e.push(b);return new G(a.a,d,d,e)}function da(a){var b=10;var d=2*Math.PI/b;let c=[],e=[],h,f;for(let g=0;g<b;++g)h=0==g%2?1:2,f=0==g%2?2:1,c.push(Math.cos(d*g)*h,Math.sin(d*g)*h,Math.cos(d*(g+1))*f,Math.sin(d*(g+1))*f,0,0);b*=3;for(d=0;d<b;++d)e.push(d);return new G(a.a,c,c,e)}class ea{constructor(a){this.a=a}};function I(a,b){return Math.max(0,Math.min(a,b))};function fa(a){let b=new ea(a.a);a.u=[new G(b.a,[0,0,1,0,1,1,0,1],[0,0,1,0,1,1,0,1],[0,1,2,2,3,0]),new G(b.a,[0,0,1,1,0,1],[0,0,1,1,0,1],[0,1,2]),new G(b.a,[0,-1,.71,.71,-.71,.71],[0,0,1,1,0,1],[0,1,2]),H(b),H(b,null,2,.25,.33),ca(b,d=>[Math.cos(1.25*(d-Math.PI)/4)*Math.sin(d-Math.PI),Math.cos(d-Math.PI)]),da(b)]}function K(a){var b=window.innerWidth,d=window.innerHeight;a.c.width=b;a.c.height=d;a.a.viewport(0,0,b,d);a.i=a.c.width;a.o=a.c.height;a.top=-1;a.left=-a.i/a.o}
function L(a,b,d,c,e,h,f){let g=a.a;null!=c&&z(a.b,c,e,h,f);a.N!=b&&(b.bind(g),a.N=b);null!=d&&d.bind(g);b.B(g)}function M(a,b,d,c,e,h){0>e&&(d-=e);0>h&&(c-=h);L(a,a.u[I(b|0,a.u.length-1)],null,d,c,e,h)}
function N(a,b,d,c,e,h,f,g,k,l){let p=a.L.i/16,n=c;let t=h/64,B=f/64;c=d-=b.length/2*(p+e)*t;let u=0;for(let F=0;F<b.length;++F){var q=b.charCodeAt(F);if(10==q)c=d,n+=(p+0)*B;else{null!=g&&(u=Math.sin(l+F*g)*k);var x=a,r=a.L,oa=q%16*p;q=(q/16|0)*p;var V=p,W=p;z(x.b,c,n+u,h,f);{var J=x.b;V/=r.i;W/=r.o;let X=J.b;X.uniform2f(J.c,oa/r.i,q/r.o);X.uniform2f(J.f,V,W)}L(x,x.u[0],r);c+=(p+e)*t}}}function O(a,b){a.b=b?a.S:a.T;A(a.b);a.h(1,1,1,1);E(a)}
class ha extends ba{constructor(){super();var a=document.createElement("div");a.setAttribute("style","position: absolute; top: 0; left: 0; z-index: -1");this.c=document.createElement("canvas");this.c.width=window.innerWidth;this.c.height=window.innerHeight;this.c.setAttribute("style","position: absolute; top: 0; left: 0; z-index: -1");a.appendChild(this.c);document.body.appendChild(a);this.a=null;a=this.a=this.c.getContext("webgl",{alpha:!1});if(null===a)throw"Failed to initialize WebGL.";a.activeTexture(a.TEXTURE0);
a.disable(a.DEPTH_TEST);a.enable(a.BLEND);a.blendFuncSeparate(a.SRC_ALPHA,a.ONE_MINUS_SRC_ALPHA,a.ONE,a.ONE_MINUS_SRC_ALPHA);a.enableVertexAttribArray(0);a.enableVertexAttribArray(1);fa(this);this.T=new C(this.a,"\nattribute vec2 v;\nattribute vec2 uvp;\n   \nuniform mat3 transform;\n\nuniform vec2 pos;\nuniform vec2 size;\n\nvarying vec2 uv;\n   \nvoid main() {\n\n    vec3 op = transform * vec3(v * size + pos, 1);\n    gl_Position = vec4(op, 1);\n    uv = uvp;\n}","\nprecision mediump float;\n \nuniform sampler2D t0;\nuniform vec4 color;\n\nuniform vec2 texPos;\nuniform vec2 texSize;\n\nvarying vec2 uv;\n\nvoid main() {\n\n    gl_FragColor = color;\n}\n");
this.b=this.S=new C(this.a,"\nattribute vec2 v;\nattribute vec2 uvp;\n   \nuniform mat3 transform;\n\nuniform vec2 pos;\nuniform vec2 size;\n\nvarying vec2 uv;\n   \nvoid main() {\n\n    vec3 op = transform * vec3(v * size + pos, 1);\n    gl_Position = vec4(op, 1);\n    uv = uvp;\n}","\nprecision mediump float;\n \nuniform sampler2D t0;\nuniform vec4 color;\n\nuniform vec2 texPos;\nuniform vec2 texSize;\n\nvarying vec2 uv;\n\nvoid main() {\n      \n    const float DELTA = 0.001;\n    vec2 tex = uv;    \n    tex.x *= texSize.x;\n    tex.y *= texSize.y;\n    tex += texPos;\n    vec4 res = color * texture2D(t0, tex);\n    if(res.a <= DELTA) {\n        discard;\n    }\n    gl_FragColor = res;\n}\n");
A(this.b);{a=document.createElement("canvas");a.width=1024;a.height=1024;var b=a.getContext("2d");b.font="56px sans-serif";b.textAlign="center";let e;for(let h=33;123>h;++h){var d=h%16;e=h/16|0;b.fillStyle="#000000";for(var c=-3;3>=c;++c)for(let f=-3;3>=f;++f)if(c!=f||0!=c)for(let g=-2;2>=g;++g)b.fillText(String.fromCharCode(h),64*d+32+g+c,64*e+48+f);b.fillStyle="#FFFFFF";for(c=-2;2>=c;++c)b.fillText(String.fromCharCode(h),64*d+32+c,64*e+48)}b=this.a;d=b.createTexture();b.bindTexture(b.TEXTURE_2D,
d);b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MIN_FILTER,b.LINEAR);b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MAG_FILTER,b.LINEAR);b.texImage2D(b.TEXTURE_2D,0,b.RGBA,b.RGBA,b.UNSIGNED_BYTE,a);a.remove();this.L=new aa(d,1024,1024)}this.N=null;K(this);this.I=1}clear(a,b,d){let c=this.a;c.clearColor(a,b,d,1);c.clear(c.COLOR_BUFFER_BIT)}h(a,b,d,c){null==a&&(a=1);null==b&&(b=1);null==d&&(d=1);null==c&&(c=1);this.b.h(a,b,d,c*this.I)}};class ia{constructor(){this.keys={};window.addEventListener("keydown",a=>{a.preventDefault();a=a.keyCode;1!=this.keys[a]&&(this.keys[a]=2)});window.addEventListener("keyup",a=>{a.preventDefault();a=a.keyCode;0!=this.keys[a]&&(this.keys[a]=3)})}update(){for(let a in this.keys)2==this.keys[a]?this.keys[a]=1:3==this.keys[a]&&(this.keys[a]=0)}getKey(a){return this.keys[a]|0}};function P(a,b){a.b+=b-a.l;let d=Math.floor(a.b/a.target)|0,c=0<d;5<d&&(a.b=5*a.target,d=5);for(;0<d--;)null!=a.a&&null!=a.a.update&&a.a.update(a.f),a.f.input.update(),a.b-=a.target;c&&null!=a.a&&null!=a.a.B&&a.a.B(a.c);a.l=b;window.requestAnimationFrame(e=>P(a,e))}class ja{constructor(){this.u=[];this.a=null;this.l=this.b=0;this.frameRate=30;this.target=0;this.f={V:this,input:new ia};this.c=new ha(128,96);window.addEventListener("resize",()=>K(this.c))}};const ka=[{i:7,o:7,data:[8,1,2,0,1,3,1,0,1,3,2,1,1,3,1,0,2,1,1,0,3,1,4,0,2,1,1,0,1,3,1,0,1,1,1,0,2,1,1,2,1,1,2,0,1,3,8,1]},{i:7,o:7,data:[8,1,5,0,2,1,5,0,2,1,2,0,1,2,2,0,2,1,5,0,2,1,5,0,8,1]}];function Q(a,b,d){return 0>b||0>d||b>=a.i||d>=a.o?1:a.data[d*a.i+b]}function R(a,b,d,c,e){d=64*(d+.5);c=64*(c+.5);b.h(.75,0,1);M(b,0,d-29*e,c-29*e,58*e,58*e);let h;for(let f=0;4>f;++f)h=1-(.25*f+.25*a.b)%1,b.h(.75*h,0,h),M(b,0,d-58*h/2*e,c-58*h/2*e,58*h*e,58*h*e)}
class la{constructor(a,b){a=ka[a-1];this.data=Array(a.i*a.o);let d=0;for(let h=0;h<a.data.length-1;h+=2){var c=a.data[h];var e=a.data[h+1];for(let f=0;f<c;++f)this.data[d++]=e}this.i=a.i;this.o=a.o;this.A=Array(a.i*a.o);this.A.fill(0);this.b=0;this.a=30;this.M=new D;for(a=0;a<this.o;++a)for(e=0;e<this.i;++e)switch(c=Q(this,e,a),c){case 1:this.A[a*this.i+e]=1;break;case 2:null==b.w&&(b.w=new ma(e,a));this.M.x=64*(e+.5);this.M.y=64*(a+.5);break;case 3:c=b,c.f.push(new na(e,a)),++c.K}}update(a,b){a&&
(0<this.a&&(this.a-=1*b.step,this.a=Math.max(0,this.a)),this.b=(this.b+.025*b.step)%1)}};function pa(a,b){if(!a.s)return!0;if(!a.C)return!1;0>=(a.J-=1*b.step)&&(a.C=!1,a.s=!1);return!0}function qa(a,b){a.v&&(null==a.m&&(a.F-=b.step),0>=a.F&&(a.F=0,a.v=!1,a.g=a.target.clone()),b=a.F/30,a.a.x=64*(a.g.x*b+(1-b)*a.target.x),a.a.y=64*(a.g.y*b+(1-b)*a.target.y))}
class ra{constructor(a,b){this.g=new D(a|0,b|0);this.a=new D(64*a,64*b);this.F=this.depth=0;this.target=this.g.clone();this.v=!1;this.s=!0;this.m=null;this.J=0;this.C=!1}finish(a,b){return this.C||!this.s?!0:2==Q(a,this.g.x,this.g.y)?(a.A[this.g.y*a.i+this.g.x]=0,this.J=30,this.C=!0,sa(b,this.a.x+32,this.a.y+32,6,this.depth,[1,1,1]),!0):!1}};class na extends ra{constructor(a,b){super(a,b);this.b=0;this.depth=this.a.y+32+16}update(a,b){pa(this,b)||(null!=this.m&&(this.m.C?this.v||(this.g=this.target.clone(),this.target=this.m.target.clone(),this.v=!0,a.A[this.g.y*a.i+this.g.x]=0):!this.m.v||this.v||this.g.x==this.m.g.x&&this.g.y==this.m.g.y||2==a.A[this.m.g.y*a.i+this.m.g.x]||(this.target=this.m.g.clone(),this.v=!0,a.A[this.g.y*a.i+this.g.x]=0,this.m.C||(a.A[this.target.y*a.i+this.target.x]=2)),this.v&&(this.F=this.m.C?this.m.J:this.m.F,
this.b=(1-this.F/30)*(this.g.x%2==this.g.y%2==0?1:-1))),qa(this,b),this.depth=this.a.y+32+16)}B(a){const b=[6,3,0],d=[0,0,-2,-6],c=[0,0,-2,-6];var e=[[0,0,0],[.5,.45,.4],[.85,.8,.75],[1,1,1]];const h=[[0,0,0],[.8,.25,.15],[1,.5,.4],[1,.8,.8]];var f=this.a.x+32;let g=this.a.y+32+-8;e=this.m?e:h;if(this.s){this.C&&(a.I=I(this.J/30,1));a.h(0,0,0,.25);M(a,3,f,g+24,24,8);a.push();a.translate(f,g);a.rotate(Math.sin(this.b*Math.PI)*Math.PI/6);E(a);for(f=0;3>f;++f)a.h(...e[f]),M(a,5,d[f],c[f],22+b[f],22+
b[f]);a.h(...e[3]);M(a,3,d[3],c[3],10,10);a.pop();a.I=I(1,1)}}};class ma extends ra{constructor(a,b){super(a,b);this.c=this.K=this.b=this.f=0}update(a,b){if(!pa(this,b)){{let d=this.g.x|0,c=this.g.y|0;this.v||(1==b.input.getKey(37)?--d:1==b.input.getKey(39)?++d:1==b.input.getKey(38)?--c:1==b.input.getKey(40)&&++c,0<a.A[c*a.i+d]||d==(this.g.x|0)&&c==(this.g.y|0)||(this.v=!0,this.F=30,this.target.x=d,this.target.y=c))}qa(this,b);a=2*Math.PI/30;this.v?(this.b+=a*b.step,this.c+=a*b.step,this.b%=2*Math.PI,this.c%=2*Math.PI,this.f=0):(this.c=this.b=0,this.f+=.05*b.step,
this.b%=2*Math.PI);this.depth=this.a.y+32+18}}B(a){var b=Math.PI/16;const d=[.67,.4,.1],c=[[1,.7,0],[.8,.4,0]];if(this.s){var e=this.a.x+32,h=this.a.y+32;this.C&&(a.I=I(this.J/30,1));a.h(0,0,0,.25);M(a,3,e,h+-2+10+12,24,7);var f=h+-12+10,g=4*Math.sin(this.c);for(let k=-1;1>=k;k+=2)a.h(0,0,0),M(a,2,e+10*k-1+1,f+g*k,20,-12),a.h(...d),M(a,2,e+10*k,f+g*k,16,-10);a.push();a.translate(e,h+-12+2*Math.sin(this.f));a.rotate(Math.sin(this.b)*b);E(a);a.h(0,0,0);M(a,0,-27,-23,54,46);a.h(...[.9,.9,.9]);M(a,0,
-24,-20,48,40);for(b=-1;1>=b;b+=2)a.h(0,0,0),M(a,3,12*b,-6,10,10),a.h(),M(a,3,12*b+2,-8,3,3);for(b=0;2>b;++b)a.h(...c[b]),M(a,1,-16*(1-b),0,-16+32*b,16);a.pop();a.I=I(1,1)}}};class ta{constructor(){this.g=new D;this.speed=new D;this.b=this.a=0;this.f=1;this.c=[1,1,1];this.scale=32;this.depth=0;this.s=!1}update(a){this.s&&(this.speed.y+=.2*a.step,this.speed.y=Math.min(4,this.speed.y),this.a+=this.speed.x/8*.25*a.step,0>=(this.b-=this.f*a.step)&&(this.s=!1),this.g.x+=this.speed.x*a.step,this.g.y+=this.speed.y*a.step)}B(a){this.s&&(a.push(),a.translate(this.g.x,this.g.y),a.rotate(this.a),E(a),a.h(...this.c,this.b/60),M(a,6,0,0,this.scale,this.scale),a.pop())}};function sa(a,b,d,c,e,h){let f=Math.random()*Math.PI*2,g=2*Math.PI/c;for(let q=0;q<c;++q){{let x;var k=a,l=b,p=d,n=4*Math.cos(f),t=4*Math.sin(f)-4,B=h,u=e;for(let r=0;r<k.a.length;++r)if(!(x=k.a[r]).s){k=x;k.g=new D(l,p);k.speed=new D(n,t);k.a=Math.random()*Math.PI*2;k.b=60;k.f=1;k.c=null==B?[1,1,1]:B;k.scale=10;k.depth=u;k.s=!0;break}}f+=g}}
function ua(a){a.b=[];a.b.push(a.w);for(var b=0;b<a.f.length;++b)a.b.push(a.f[b]);for(b=0;b<a.a.length;++b)a.a[b].s&&a.b.push(a.a[b]);a.b.sort((d,c)=>d.depth-c.depth)}function S(a){return a.w.K==a.K}
class va{constructor(){this.w=null;this.f=[];this.c=[];this.a=Array(16);for(let a=0;a<this.a.length;++a)this.a[a]=new ta;this.b=[];this.K=0}update(a,b,d){null!=this.w&&this.w.update(a,d);for(let g=0;g<this.f.length;++g){var c=this.f[g],e=this.w,h=this.c,f=a;null==c.m&&c.s&&e.g.x==c.g.x&&e.g.y==c.g.y&&(0!=h.length&&(h[h.length-1].m=c),c.m=e,h.push(c),++e.K,sa(this,c.a.x+32,c.a.y+32,5,c.depth,[1,.25,.2]),f.A[c.g.y*f.i+c.g.x]=2)}for(c=this.c.length-1;0<=c;--c)this.c[c].update(a,d);(c=null==this.w||S(this)&&
this.w.finish(a,this))||(e=this.w,e.v?c=!1:(c=e.g.x|0,e=e.g.y|0,c=0<a.A[e*a.i+(c-1)]&&0<a.A[e*a.i+(c+1)]&&0<a.A[(e-1)*a.i+c]&&0<a.A[(e+1)*a.i+c]),c=!c);if(c){for(b=this.c.length-1;0<=b;--b)this.c[b].finish(a,this);for(a=0;a<this.a.length;++a)this.a[a].update(d)}else T(b,1)}B(a){ua(this);for(let b=0;b<this.b.length;++b)this.b[b].B(a)}};function wa(a,b,d,c,e,h,f,g){a.a=b;a.speed=d;a.c.r=c;a.c.R=e;a.c.P=h;a.b=60;null!=f&&(a.u=f);a.l=g?g:0;a.f=a.l;a.active=!0}function U(a){let b=a.b/60;a.a&&(b=1-b);return b}function xa(a){if(.001>=a.l)return 0;let b=a.f/a.l;a.a&&(b=1-b);return b}
class ya{constructor(){this.b=0;this.u=()=>{};this.c={r:0,R:0,P:0};this.active=!1;this.speed=1;this.a=!1;this.f=0;this.l=1}update(a){this.active&&!(0<(this.f-=1*a.step))&&0>=(this.b-=this.speed*a.step)&&(0==(this.a=!this.a)?(this.u(a),this.b+=60):(this.active=!1,this.b=0))}B(a){!this.active||0<this.f||(a.h(this.c.r,this.c.R,this.c.P,U(this)),M(a,0,0,0,a.viewport.x,a.viewport.y))}};const Y=[.33,.67,1];function T(a,b){wa(a.a,!0,b?3-b:2,...Y,()=>{za(a,2==b?++a.id:0)},30*b);a.f=b}function za(a,b){null==b&&(b=a.id);a.c=new va;a.l=new la(b,a.c)}function Z(a,b,d,c,e){a.push();a.translate(b+16,d+8);a.rotate(e);E(a);a.h(0,0,0,.25);M(a,4,0,0,c,c);a.pop();a.push();a.translate(b,d);a.rotate(e);E(a);a.h(...[.5,.5,.5]);M(a,4,0,0,c,c);a.h(...[.75,.75,.75]);M(a,4,0,0,c-8,c-8);a.pop()}
class Aa{constructor(){this.id=1;za(this);this.H=this.b=0;this.a=new ya;wa(this.a,!1,1,...Y);this.u=this.f=0}update(a){var b=Math.PI/2/30;this.H+=.05*a.step;var d=this.c;d.w.v||d.w.C||!d.w.s||this.a.active?(b=this.b+b*(this.a.active?-1:1)*a.step,d=Math.PI/2,this.b=0>b?d- -b%d:b%d):this.b=0;this.a.active?(0<this.f&&(this.u=(this.u+.025*a.step)%(2*Math.PI)),this.a.update(a)):(this.l.update(S(this.c),a),this.c.update(this.l,this,a),b=this.c,0<b.c.length&&!b.c[0].s?T(this,2):2==a.input.getKey(82)&&T(this))}B(a){var b=
Math.PI/3;a.clear(...Y);O(a,!1);var d=1,c=1,e=null,h=null,f=null;this.a.active&&(2==this.f&&this.a.a&&(e=this.l.M.x,h=this.l.M.y,c=8,f=-b*U(this.a)),d=U(this.a),d=1+d*c*.25*(this.a.a?1:-1));b=this.l;c=64*b.o;var g=a.i/a.o*c;v(a.O,g,c);a.viewport.x=g;a.viewport.y=c;a.G=!1;c=64*b.i/2;b=64*b.o/2;g=a.viewport.x/2-c;null!=e&&(c=e);null!=h&&(b=h);a.translate(g,0);a.translate(c,b);null!=f&&a.rotate(f);a.scale(d,d);a.translate(-c,-b);E(a);d=this.l;b=S(this.c);for(e=0;e<d.o;++e)for(h=0;h<d.i;++h){var k=Q(d,
h,e);switch(k){case 1:{f=d;c=a;g=h;var l=e;var p=[[.9,.95,1],[.6,.8,1],[.05,.25,.6],[.15,.45,.8],[.33,.67,1]],n=[1!=Q(f,g-1,l),1!=Q(f,g,l-1),1!=Q(f,g+1,l),1!=Q(f,g,l+1)];c.h(...p[4]);M(c,0,64*g,64*l,64,64);n[2]&&(c.h(...p[2]),M(c,0,64*g+51.2,64*l,12.8,64));n[3]&&(c.h(...p[3]),M(c,0,64*g,64*l+51.2,64,12.8),n[2]&&(c.h(...p[2]),M(c,1,64*g+51.2,64*l+51.2,-12.8,-12.8)));n[0]&&(c.h(...p[0]),M(c,0,64*g,64*l,12.8,64),n[3]&&(c.h(...p[3]),M(c,1,64*g,64*l+51.2,-12.8,12.8)));n[1]&&(c.h(...p[1]),M(c,0,64*g,64*
l,64,12.8),n[0]&&(c.h(...p[0]),M(c,1,64*g,64*l,12.8,12.8)),n[2]&&(c.h(...p[2]),M(c,1,64*g+51.2,64*l,-12.8,12.8)));var t=[0,1,1,0],B=[0,0,1,1],u=[-1,-1,1,1];const x=[-1,1,1,-1];for(let r=0;4>r;++r){var q=t[r];k=B[r];n[r]||n[(r+1)%4]||1==Q(f,g-1+2*q,l-1+2*k)||(c.h(...p[r]),M(c,1,64*g+51.2*q,64*l+51.2*k,12.8*u[r],12.8*x[r]),c.h(...p[(r+1)%4]),M(c,1,64*g+51.2*q,64*l+51.2*k,-12.8*u[r],-12.8*x[r]))}}break;default:f=d;c=a;g=h;l=e;q=[1!=Q(f,g-1,l),1!=Q(f,g,l-1),1!=Q(f,g+1,l),1!=Q(f,g,l+1)];g%2==l%2?c.h(.9,
.75,.5):c.h(.8,.55,.3);M(c,0,64*g,64*l,64,64);c.h(0,0,0,.25);p=1==Q(f,g-1,l-1);t=n=0;q[0]?q[1]?p&&M(c,0,64*g,64*l,16,16):(q[0]&&!p&&(n=3),M(c,q[0]&&!p?1:0,64*g-n,3+64*l,-16,-13),M(c,0,64*(g+.25)-n,3+64*l,48+n,13)):(q[1]&&!p&&(t=1,n=3),M(c,0,3+64*g,64*(l+.25)-n,13,48+n),M(c,t,3+64*g,64*l-n,13,16),q[1]||M(c,0,64*(g+.25),64*l,48,16));c.h(0,0,0);q[0]||M(c,0,64*g,64*l,3,64);q[1]||M(c,0,64*g,64*l,64,3);q[2]||M(c,0,64*(g+1)-3,64*l,3,64);q[3]||M(c,0,64*g,64*(l+1)-3,64,3);t=[0,1,1,0];B=[0,0,1,1];for(u=0;4>
u;++u)n=t[u],p=B[u],q[u]&&q[(u+1)%4]&&1==Q(f,g-1+2*n,l-1+2*p)&&M(c,0,64*g+61*n,64*l+61*p,3,3);if(2==k)if(l=d.a/30,b&&0>=l)R(d,a,h,e,1);else if(!b||0<l)f=a,c=h,g=e,f.push(),f.translate(64*(c+.5),64*(g+.5)),f.rotate(Math.PI/4),E(f),f.h(.67,0,0),M(f,0,-25.6,-8,51.2,16),M(f,0,-8,-25.6,16,51.2),f.pop(),R(d,a,h,e,1-l)}}this.c.B(a);m(a.D);a.G=!1;d=a.i/a.o*720;v(a.O,d,720);a.viewport.x=d;a.viewport.y=720;a.G=!1;E(a);this.a.B(a);if(this.a.active&&0<this.f){d=["STUCK","STAGE CLEAR"][this.f-1];b=[[1,.4,0],[1,
1,.5]][this.f-1];e=a.viewport.y/2;h=a.viewport.x/2-72*(d.length-1)/2;O(a,!0);f=U(this.a);this.a.a&&(f=xa(this.a));c=1/d.length;for(l=0;l<d.length;++l)for(k=(f-c*(this.a.a?l:d.length-1-l))/c,k=I(k,1),g=-64+64*k+-16*Math.sin(this.u+l*Math.PI*2/d.length),a.I=I(k,1),k=1;0<=k;--k)0==k?a.h(...b):a.h(0,0,0,.25),N(a,d.charAt(l),h+72*l+8*k,e-48+g+8*k,0,96,96);O(a,!1);a.I=I(1,1)}Z(a,0,0,128,this.b);Z(a,a.viewport.x,0,96,-this.b);Z(a,0,a.viewport.y,96,-this.b);Z(a,a.viewport.x,a.viewport.y,128,this.b);d=["STAGE "+
String(this.id),"Password: NONE"];b=[64,48];e=[6,4];h=[Math.PI/3,Math.PI/6];f=[6,4];c=[6,4];O(a,!0);for(k=0;2>k;++k)for(l=2==this.f&&this.a.active?Math.max(U(this.a),xa(this.a))*(e[k]+b[k]):0,q=1;0<=q;--q)g=0==k?36:a.viewport.y-4-32,g-=b[k]/2-q*c[k],g-=(1-2*k)*l,1==q?a.h(0,0,0,.25):a.h(1,1,.5),N(a,d[k],a.viewport.x/2+q*f[k],g,-16,b[k],b[k],h[k],e[k],this.H)}};window.onload=()=>{let a=new ja;var b=new Aa(a.c.a);a.u.game=b;a.a=b;a.frameRate=60;a.f.step=60/a.frameRate;a.target=1E3/a.frameRate;P(a,0)};
