'use strict';class r{constructor(a,b,c){this.a=a;this.j=b;this.l=c}bind(a){a.bindTexture(a.TEXTURE_2D,this.a)}};class v{constructor(a,b){this.x=null==a?0:a;this.y=null==b?0:b}clone(){return new v(this.x,this.y)}}class w{constructor(a,b,c){this.x=null==a?0:a;this.y=null==b?0:b;this.z=null==c?0:c}clone(){return new w(this.x,this.y,this.z)}};function A(a){for(let b=0;4>b;++b)for(let c=0;4>c;++c)a.c[4*b+c]=b==c?1:0}function B(a,b,c,d){let e=Math.cos(0*b),g=Math.sin(0*b),h=Math.cos(b*c);c=Math.sin(b*c);let f=Math.cos(b*d);b=Math.sin(b*d);A(a);a.c[0]=h*f;a.c[1]=-h*b;a.c[2]=c;a.c[4]=g*c*f+e*b;a.c[5]=-g*c*b+e*f;a.c[6]=-g*h;a.c[8]=-e*c*f;a.c[9]=e*c*b+g*f;a.c[10]=e*h}function C(a){let b=new D;for(let c=0;4>c;++c)for(let d=0;4>d;++d)b.c[4*d+c]=a.c[4*c+d];return b}
class D{constructor(){this.c=new Float32Array(16);A(this)}multiply(a){let b=new D;for(var c=0;4>c;++c)for(var d=0;4>d;++d)b.c[4*c+d]=0;for(c=0;4>c;++c)for(d=0;4>d;++d)for(let e=0;4>e;++e)b.c[4*c+d]+=this.c[4*c+e]*a.c[4*e+d];return b}clone(){let a=new D;for(let b=0;16>b;++b)a.c[b]=this.c[b];return a}};function F(a,b,c,d,e,g,h){let f=a.b;f.uniform3f(a.I,b,c,d);f.uniform3f(a.J,e,g,h)}function I(a){var b=a.b;b.useProgram(a.a);b.uniform1i(a.K,0);b.uniform1i(a.L,1);F(a,0,0,0,1,1,1);b=a.b;b.uniform2f(a.g,0,0);b.uniform2f(a.i,1,1);b=new D;a.b.uniformMatrix4fv(a.f,!1,C(b).c);b=new D;a.b.uniformMatrix4fv(a.m,!1,C(b).c)}
class J{constructor(a,b,c){this.b=a;this.a=null;{let d=this.b;b=this.createShader(b,d.VERTEX_SHADER);c=this.createShader(c,d.FRAGMENT_SHADER);this.a=d.createProgram();d.attachShader(this.a,b);d.attachShader(this.a,c);c=this.b;c.bindAttribLocation(this.a,0,"v");c.bindAttribLocation(this.a,1,"uvp");c.bindAttribLocation(this.a,2,"n");d.linkProgram(this.a);if(!d.getProgramParameter(this.a,d.LINK_STATUS))throw"Shader error: "+d.getProgramInfoLog(this.a);}this.m=a.getUniformLocation(this.a,"transform");
this.f=a.getUniformLocation(this.a,"rotation");this.o=a.getUniformLocation(this.a,"color");this.K=a.getUniformLocation(this.a,"t0");this.L=a.getUniformLocation(this.a,"t1");this.v=a.getUniformLocation(this.a,"fogColor");this.C=a.getUniformLocation(this.a,"fogMin");this.A=a.getUniformLocation(this.a,"fogMax");this.I=a.getUniformLocation(this.a,"pos");this.J=a.getUniformLocation(this.a,"size");this.g=a.getUniformLocation(this.a,"texPos");this.i=a.getUniformLocation(this.a,"texSize");this.F=a.getUniformLocation(this.a,
"lightDir");this.M=a.getUniformLocation(this.a,"lightMag")}createShader(a,b){let c=this.b;b=c.createShader(b);c.shaderSource(b,a);c.compileShader(b);if(!c.getShaderParameter(b,c.COMPILE_STATUS))throw"Shader error:\n"+c.getShaderInfoLog(b);return b}D(a,b,c,d){let e=this.b;e.uniform3f(this.F,b,c,d);e.uniform1f(this.M,a)}};function K(a,b){return 0>a?b- -a%b:a%b};function L(a,b,c,d,e,g){null==g&&(g=1);let h=new Uint8Array(65536);h.fill(255);for(let E=0;4>E;++E)for(let G=0;4>G;++G){{let O,P,x,k,l;var f=h,n=32*G+E%2*a,p=32*E,y=0>e&&G%2==E%2?c:b,z=d,m=e,H=0>e?null:c,q=0,V=g;if(null==m||0>m)m=0;null==q&&(q=0);let fa=y.x/255,ha=y.y/255,ia=y.z/255;for(let t=0;32>t;++t)for(let u=0;32>u;++u)l=4*K(n+t,128),k=4*K(p+u,128),null!=H&&(t<q||u<q||t>=32-q||u>=32-q)?(f[128*k+l]=H.x,f[128*k+l+1]=H.y,f[128*k+l+2]=H.z):0<m&&(t<q+m||u<q+m||t>=32-q-m||u>=32-q-m)?(f[128*k+l]=0,
f[128*k+l+1]=0,f[128*k+l+2]=0):t>=z&&u>=z&&t<32-z&&u<32-z?(f[128*k+l]=y.x,f[128*k+l+1]=y.y,f[128*k+l+2]=y.z):(P=t-(32-m-q)/2,O=u-(32-m-q)/2,x=(16-Math.max(Math.abs(P),Math.abs(O)))/z,x=P>O?1-V+V*x:2-x,x=Math.max(0,x),f[128*k+l]=Math.max(0,Math.min(255*fa*x|0,255)),f[128*k+l+1]=Math.max(0,Math.min(255*ha*x|0,255)),f[128*k+l+2]=Math.max(0,Math.min(255*ia*x|0,255)))}}return{data:h,j:128,l:128}}
function aa(){var a=new w(176,160,128);let b=new Uint8Array(65536);b.fill(255);let c=5342,d;for(let e=0;16384>e;++e)c=(262143*c+12345)%655351,d=c%256/256,d=.75+.25*d,b[4*e]=a.x*d|0,b[4*e+1]=a.y*d|0,b[4*e+2]=a.z*d|0;return{data:b,j:128,l:128}}
class M{constructor(a){this.a=a}createTexture(a){let b=this.a,c=b.createTexture();b.bindTexture(b.TEXTURE_2D,c);b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MIN_FILTER,b.LINEAR);b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MAG_FILTER,b.LINEAR);b.texImage2D(b.TEXTURE_2D,0,b.RGBA,a.j,a.l,0,b.RGBA,b.UNSIGNED_BYTE,a.data);return new r(c,a.j,a.l)}};class N{constructor(a,b,c,d,e){this.i=d.length;this.g=a.createBuffer();this.f=a.createBuffer();this.a=a.createBuffer();this.b=a.createBuffer();a.bindBuffer(a.ARRAY_BUFFER,this.g);a.bufferData(a.ARRAY_BUFFER,new Float32Array(b),a.STATIC_DRAW);a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,this.a);a.bufferData(a.ELEMENT_ARRAY_BUFFER,new Uint16Array(d),a.STATIC_DRAW);a.bindBuffer(a.ARRAY_BUFFER,this.f);a.bufferData(a.ARRAY_BUFFER,new Float32Array(c),a.STATIC_DRAW);a.bindBuffer(a.ARRAY_BUFFER,this.b);a.bufferData(a.ARRAY_BUFFER,
new Float32Array(e),a.STATIC_DRAW)}bind(a){a.bindBuffer(a.ARRAY_BUFFER,this.g);a.vertexAttribPointer(0,3,a.FLOAT,a.G,0,0);a.bindBuffer(a.ARRAY_BUFFER,this.f);a.vertexAttribPointer(1,2,a.FLOAT,a.G,0,0);a.bindBuffer(a.ARRAY_BUFFER,this.b);a.vertexAttribPointer(2,3,a.FLOAT,a.G,0,0);a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,this.a)}u(a){a.drawElements(a.TRIANGLES,this.i,a.UNSIGNED_SHORT,0)}};function Q(a,b,c,d,e,g){A(a.view);a.s=!1;null!=b&&(null==g&&(g=0),B(a.g,g,0,1),B(a.i,e+Math.PI/2,1,0),a.g=a.g.multiply(a.i),e=a.i,A(e),e.c[3]=b,e.c[7]=c,e.c[11]=d,a.view=a.g.multiply(a.i))}function R(a){if(null!=a.a){a.s||(a.m=a.B.multiply(a.view.multiply(a.w)),a.s=!0);var b=a.a;b.b.uniformMatrix4fv(b.m,!1,C(a.m).c);b=a.a;b.b.uniformMatrix4fv(b.f,!1,C(a.g).c)}}
class ba{constructor(){this.B=new D;this.view=new D;this.w=new D;this.m=new D;this.g=new D;this.i=new D;this.s=!1;this.a=null;this.A=[]}push(){this.A.push(this.w.clone())}};function S(a){var b=window.innerWidth,c=window.innerHeight;a.f.width=b;a.f.height=c;a.b.viewport(0,0,b,c);a.j=a.f.width;a.l=a.f.height;a.top=-1;a.left=-a.j/a.l}function T(a,b,c,d,e,g,h,f,n){let p=a.b;null!=d&&F(a.a,d,e,g,h,f,n);a.o!=b&&(b.bind(p),a.o=b);null!=c&&c.bind(p);b.u(p)}function U(a){a=a.a;a.b.uniform4f(a.o,1,1,1,1)}function ca(a,b){let c=a.b;b?c.enable(c.DEPTH_TEST):(c.disable(c.DEPTH_TEST),A(a.w),a.s=!1,Q(a),R(a))}
function da(a,b,c,d,e,g,h){a.s=!1;if(b){a.a=a.F;I(a.a);{b=a.a;let f=b.b;f.uniform4f(b.v,e,g,h,1);f.uniform1f(b.C,c);f.uniform1f(b.A,d)}}else a.a=a.v,I(a.a);U(a);R(a)}
class ea extends ba{constructor(){super();var a=document.createElement("div");a.setAttribute("style","position: absolute; top: 0; left: 0; z-index: -1");this.f=document.createElement("canvas");this.f.width=window.innerWidth;this.f.height=window.innerHeight;this.f.setAttribute("style","position: absolute; top: 0; left: 0; z-index: -1");a.appendChild(this.f);document.body.appendChild(a);this.b=null;a=this.b=this.f.getContext("webgl",{alpha:!1});if(null===a)throw"Failed to initialize WebGL.";a.activeTexture(a.TEXTURE0);
a.enable(a.DEPTH_TEST);a.enable(a.BLEND);a.blendFuncSeparate(a.SRC_ALPHA,a.ONE_MINUS_SRC_ALPHA,a.ONE,a.ONE_MINUS_SRC_ALPHA);a.enableVertexAttribArray(0);a.enableVertexAttribArray(1);a.enableVertexAttribArray(2);this.C=new N(this.b,[0,0,0,1,0,0,1,1,0,0,1,0],[0,0,1,0,1,1,0,1],[0,1,2,2,3,0]);this.v=new J(this.b,"\nattribute vec3 v;\nattribute vec2 uvp;\nattribute vec3 n;\n   \nuniform mat4 transform;\nuniform mat4 rotation;\n\nuniform vec3 pos;\nuniform vec3 size;\n\nvarying vec2 uv;\nvarying vec3 rot;\nvarying float dist;\n   \nvoid main() {\n\n    vec3 p = v * size + pos;\n    vec4 o = transform * vec4(p, 1);\n    gl_Position = o;\n    rot = (rotation * vec4(n,1)).xyz;\n    uv = uvp;\n    dist = sqrt(o.x*o.x + o.y*o.y + o.z*o.z);\n}",
"\nprecision mediump float;\n \nuniform sampler2D t0;\nuniform vec4 color;\nuniform vec4 fogColor;\nuniform float fogMin;\nuniform float fogMax;\n\nuniform vec2 texPos;\nuniform vec2 texSize;\n\nuniform vec3 lightDir;\nuniform float lightMag;\n\nvarying vec2 uv;\nvarying vec3 rot;\nvarying float dist;\n\nvoid main() {\n    const float DELTA = 0.001;\n    vec2 tex = uv;    \n    tex.x *= texSize.x;\n    tex.y *= texSize.y;\n    tex += texPos;\n    vec4 res = color * texture2D(t0, tex);\n    if(res.a <= DELTA) {\n        discard;\n    }\n    gl_FragColor = res;\n}\n");
this.F=new J(this.b,"\nattribute vec3 v;\nattribute vec2 uvp;\nattribute vec3 n;\n   \nuniform mat4 transform;\nuniform mat4 rotation;\n\nuniform vec3 pos;\nuniform vec3 size;\n\nvarying vec2 uv;\nvarying vec3 rot;\nvarying float dist;\n   \nvoid main() {\n\n    vec3 p = v * size + pos;\n    vec4 o = transform * vec4(p, 1);\n    gl_Position = o;\n    rot = (rotation * vec4(n,1)).xyz;\n    uv = uvp;\n    dist = sqrt(o.x*o.x + o.y*o.y + o.z*o.z);\n}","\nprecision mediump float;\n \nuniform sampler2D t0;\nuniform vec4 color;\nuniform vec4 fogColor;\nuniform float fogMin;\nuniform float fogMax;\n\nuniform vec2 texPos;\nuniform vec2 texSize;\n\nuniform vec3 lightDir;\nuniform float lightMag;\n\nvarying vec2 uv;\nvarying vec3 rot;\nvarying float dist;\n\nvoid main() {\n    const float DELTA = 0.001;\n    vec2 tex = uv;    \n    tex.x *= texSize.x;\n    tex.y *= texSize.y;\n    tex += texPos;\n    vec4 res = color * texture2D(t0, tex);\n    if(res.a <= DELTA) {\n        discard;\n    }      \n    vec4 a = gl_FragCoord;\n    float z = gl_FragCoord.z / gl_FragCoord.w;\n    float d = max(dist, z);\n    float fog = clamp(d-fogMin, 0.0, fogMax-fogMin) / \n        (fogMax-fogMin);\n    float l = (1.0-lightMag) + lightMag * dot(rot, lightDir);\n    gl_FragColor = vec4((1.0-l)*((1.0-fog)*res.xyz + fog*fogColor.xyz), res.a);\n}\n");
this.a=this.v;I(this.a);(new M(this.b)).createTexture({data:new Uint8Array([255,255,255,255]),j:1,l:1});{a=document.createElement("canvas");a.width=1024;a.height=1024;var b=a.getContext("2d");b.font="32px sans-serif";b.fillStyle="#FFFFFF";b.textAlign="center";let d;for(let e=0;256>e;++e){var c=e%16;d=e/16|0;b.fillText(String.fromCharCode(e),64*c+32,64*d+32)}b=this.b;c=b.createTexture();b.bindTexture(b.TEXTURE_2D,c);b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MIN_FILTER,b.LINEAR);b.texParameteri(b.TEXTURE_2D,
b.TEXTURE_MAG_FILTER,b.LINEAR);b.texImage2D(b.TEXTURE_2D,0,b.RGBA,b.RGBA,b.UNSIGNED_BYTE,a);a.remove();this.H=new r(c,1024,1024)}this.o=null;S(this)}clear(a,b,c){let d=this.b;d.clearColor(a,b,c,1);d.clear(d.COLOR_BUFFER_BIT|d.DEPTH_BUFFER_BIT)}D(a,b,c,d){this.a.D(a,b,c,d)}};class ja{constructor(){this.keys={};window.addEventListener("keydown",a=>{a.preventDefault();a=a.keyCode;1!=this.keys[a]&&(this.keys[a]=2)});window.addEventListener("keyup",a=>{a.preventDefault();a=a.keyCode;0!=this.keys[a]&&(this.keys[a]=3)})}update(){for(let a in this.keys)2==this.keys[a]?this.keys[a]=1:3==this.keys[a]&&(this.keys[a]=0)}getKey(a){return this.keys[a]|0}};function ka(a,b){a.b+=b-a.i;let c=Math.floor(a.b/a.target)|0,d=0<c;5<c&&(a.b=5*a.target,c=5);for(;0<c--;)null!=a.a&&null!=a.a.update&&a.a.update(a.g),a.g.input.update(),a.b-=a.target;d&&null!=a.a&&null!=a.a.u&&a.a.u(a.f);a.i=b;window.requestAnimationFrame(e=>ka(a,e))}class la{constructor(){this.m=[];this.a=null;this.i=this.b=0;this.frameRate=30;this.target=0;this.g={N:this,input:new ja};this.f=new ea(128,96);window.addEventListener("resize",()=>S(this.f))}};var W=[9,1,2,0,1,1,3,0,2,1,4,0,4,1,2,0,1,1,1,0,1,1,1,0,2,1,6,0,4,1,1,0,2,1,1,0,2,1,4,0,1,1,1,0,9,1];function X(a,b,c){return 0>b||0>c||b>=a.j||c>=a.l?1:a.data[c*a.j+b]}
class ma{constructor(a){this.g=this.f=this.b=null;{var b=[0,0,0,1,0,0,1,1,0,0,1,0],c=[0,0,0,1,0,0,1,0,1,0,0,1],d=[0,0,0,0,0,1,0,1,1,0,1,0],e=[0,1,2,2,3,0];const g=[0,0,1,0,1,1,0,1];let h=[[],[]],f=[[],[]],n=[[],[]];for(let p=0;4>p;++p)h[0].push(0,0,1),h[1].push(0,0,-1),f[0].push(0,-1,0),f[1].push(0,1,0),n[0].push(-1,0,0),n[1].push(1,0,0);this.b=new N(a,b,g,e,h[0]);this.f=new N(a,c,g,e,f[0]);this.g=new N(a,d,g,e,n[0]);this.i=new N(a,b,g,e,h[1]);this.m=new N(a,c,g,e,f[1]);this.o=new N(a,d,g,e,n[1])}a=
new M(a);this.a=a.createTexture(L(16,new w(144,72,32),new w(64,40,32),8,1));this.A=a.createTexture(L(0,new w(192,176,128),new w(255,224,192),5,-1,.5));this.v=a.createTexture(aa());this.data=Array(64);c=0;for(d=0;d<W.length-1;d+=2)for(b=W[d],a=W[d+1],e=0;e<b;++e)this.data[c++]=a;this.l=this.j=8}update(){}u(a){U(a);let b;for(let c=0;c<this.l;++c)for(let d=0;d<this.j;++d)b=this.data[c*this.j+d],0==b?(T(a,this.f,this.v,-d,.25,-c,1,1,1),T(a,this.m,this.A,-d,-.25,-c,1,1,1)):1==b&&(1!=X(this,d,c-1)&&T(a,
this.b,this.a,-d,-.25,-c+1,1,.5,1),1!=X(this,d,c+1)&&T(a,this.i,this.a,-d,-.25,-c,1,.5,1),1!=X(this,d+1,c)&&T(a,this.g,this.a,-d,-.25,-c,1,.5,1),1!=X(this,d-1,c)&&T(a,this.o,this.a,-d+1,-.25,-c,1,.5,1))}};function Y(a,b,c,d,e){na(a,b,c);let g=d?1:0;na(a,b+g,c+(1-g));d?(b=oa(a.h.y,a.h.x,a.o.y,a.speed.y,c,b,e),null!=b&&(a.h.y=b,a.speed.y=0)):(b=oa(a.h.x,a.h.y,a.o.x,a.speed.x,b,c,e),null!=b&&(a.h.x=b,a.speed.x=0))}function Z(a,b,c){a<b?a=Math.min(a+c,b):a>b&&(a=Math.max(a-c,b));return a}function na(a,b,c){let d=Math.hypot(a.h.x-b,a.h.y-c),e=new v;.25>d&&(b=Math.atan2(a.h.y-c,a.h.x-b),e.x=Math.cos(b)*(.25-d),e.y=Math.sin(b)*(.25-d),a.h.x+=e.x,a.h.y+=e.y,a.speed.x+=e.x,a.speed.y+=e.y)}
function oa(a,b,c,d,e,g,h){return b>g&&b<g+1&&(0<d&&c+.25<e+d*h&&a+.25>e-d*h||0>d&&c-.25>e+d*h&&a-.25<e-d*h)?e+.25*(0>d?1:-1):null}
class pa{constructor(a,b,c){this.h=new v(a,b);this.o=this.h.clone();this.speed=new v;this.target=new v;this.i=0;this.b=new w;null!=c&&(this.b.y=c);this.g=new w;this.f=new w;this.a=0;this.m=!1}update(a){this.o=this.h.clone();var b=Math.PI/6,c=0;1==a.input.getKey(37)?c=-1:1==a.input.getKey(39)&&(c=1);this.f.y=.033*c;this.m?(this.f.y/=2,this.f.z=this.i/.03*c*b):this.f.z=0;b=0;1==a.input.getKey(38)?b=-1:1==a.input.getKey(40)&&(b=1);c=(this.m=1==a.input.getKey(16))?.03:.015;this.target.x=b*Math.cos(this.b.y+
Math.PI/2)*c;this.target.y=b*Math.sin(this.b.y+Math.PI/2)*c;b=a.step;c=.0015;this.m&&.015<this.i&&(c=5E-4);c*=b;this.speed.x=Z(this.speed.x,this.target.x,c);this.speed.y=Z(this.speed.y,this.target.y,c);this.g.y=Z(this.g.y,this.f.y,.0025*b);this.g.z=Z(this.g.z,this.f.z,.02*b);this.i=Math.hypot(this.speed.x,this.speed.y);this.h.x+=this.speed.x*b;this.h.y+=this.speed.y*b;this.b.y+=this.g.y*b;this.b.y=K(this.b.y,2*Math.PI);this.b.z=this.g.z;a=a.step;b=.2*this.i/.015;c=this.a;if(.01>this.i)if(.01<this.a){if(this.a+=
b*a,this.a>=2*Math.PI||this.a>=Math.PI&&c<Math.PI)this.a=0}else this.a=0;else this.a+=b*a,this.a%=2*Math.PI}};class qa{constructor(a){this.b=new ma(a);this.a=new pa(.5,.5,Math.PI/2)}update(a){this.b.update(a.step);this.a.update(a);{var b=this.b,c=this.a;a=a.step;let d=Math.floor(c.h.x)-2,e=Math.floor(c.h.y)-2,g;for(let h=d;h<=d+4;++h)for(let f=e;f<=e+4;++f)g=X(b,h,f),1==g&&(1!=X(b,h,f-1)&&Y(c,h-1,f-1,!0,a),1!=X(b,h,f+1)&&Y(c,h-1,f,!0,a),1!=X(b,h+1,f)&&Y(c,h,f-1,!1,a),1!=X(b,h-1,f)&&Y(c,h-1,f-1,!1,a))}}u(a){var b=Math.PI/3;a.clear(0,0,0);var c=a.B,d=a.j/a.l;A(c);b=1/Math.tan(b/2);var e=1/-99.99;c.c[0]=b/d;
c.c[5]=b;c.c[10]=100.01*e;c.c[11]=2*e;c.c[14]=-1;c.c[15]=0;a.s=!1;da(a,!0,.5,5,0,0,0);a.D(1,0,0,-1);ca(a,!0);A(a.w);a.s=!1;c=this.a;Q(a,c.h.x,.02*Math.sin(c.a),c.h.y,c.b.y+Math.PI/2,c.b.z);R(a);this.b.u(a);da(a,!1);ca(a,!1);A(a.w);a.s=!1;c=a.B;d=a.j;b=a.l;A(c);c.c[0]=2/(d-0);c.c[3]=-(d+0)/(d-0);c.c[5]=2/(0-b);c.c[7]=-(0+b)/(0-b);c.c[10]=-1;c.c[11]=-0;c.c[15]=1;R(a);{e=a.H.j/16;let p=2,y=2;for(let z=0;12>z;++z){var g="Hello world!".charCodeAt(z);if(10==g)p=2,y+=1*(e+0);else{c=a;d=a.H;b=g%16*e;g=(g/
16|0)*e;var h=e,f=e;F(c.a,p,y,0,64,64,1);{var n=c.a;h/=d.j;f/=d.l;let m=n.b;m.uniform2f(n.g,b/d.j,g/d.l);m.uniform2f(n.i,h,f)}T(c,c.C,d);p+=1*(e+-32)}}}}};window.onload=()=>{let a=new la;var b=new qa(a.f.b);a.m.game=b;a.a=b;a.frameRate=60;a.g.step=60/a.frameRate;a.target=1E3/a.frameRate;ka(a,0)};
